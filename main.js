/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};

// main.ts
__export(exports, {
  default: () => WordPopupPlugin
});
var import_obsidian6 = __toModule(require("obsidian"));

// pattern_matcher.ts
var TrieNode = class {
  constructor() {
    this.children = {};
    this.value = null;
  }
};
var Trie = class {
  constructor(terms) {
    this.root = new TrieNode();
    for (const { term, value } of terms) {
      this.insert(term, value);
    }
  }
  insert(term, value) {
    let node = this.root;
    for (const char of term) {
      if (!node.children[char]) {
        node.children[char] = new TrieNode();
      }
      node = node.children[char];
    }
    node.value = value;
  }
  lookup(query) {
    const results = [];
    const visited = new Set();
    this._lookupHelper(this.root, query, 0, results, [], visited);
    return results;
  }
  _lookupHelper(node, query, index, results, wildcardMatches, visited) {
    if (index === query.length) {
      if (node.value !== null && !visited.has(node)) {
        results.push({
          value: node.value,
          match: wildcardMatches.slice()
        });
        visited.add(node);
      }
      return;
    }
    const char = query[index];
    if (node.children[char]) {
      this._lookupHelper(node.children[char], query, index + 1, results, wildcardMatches, visited);
    }
    if (char.match(/^[0-9a-z]+$/) && node.children["*"]) {
      const newWildcardMatches = wildcardMatches.concat(char);
      this._lookupHelper(node.children["*"], query, index + 1, results, newWildcardMatches, visited);
    }
  }
  typeAhead(query) {
    let nodes = [{ node: this.root, index: 0 }];
    const results = [];
    const collectedNodes = new Set();
    while (nodes.length > 0) {
      let nextNodes = [];
      for (const { node, index } of nodes) {
        if (index === query.length) {
          this._collectValues(node, results, collectedNodes);
        } else {
          const char = query[index];
          if (node.children[char]) {
            nextNodes.push({
              node: node.children[char],
              index: index + 1
            });
          }
          if (char.match(/^[0-9a-z]+$/) && node.children["*"]) {
            nextNodes.push({
              node: node.children["*"],
              index: index + 1
            });
          }
        }
      }
      nodes = nextNodes;
    }
    return results;
  }
  _collectValues(startNode, results, collectedNodes) {
    let queue = [startNode];
    const visitedNodes = new Set();
    while (queue.length > 0) {
      const node = queue.shift();
      if (visitedNodes.has(node)) {
        continue;
      }
      visitedNodes.add(node);
      if (node.value !== null && !collectedNodes.has(node)) {
        results.push(node.value);
        collectedNodes.add(node);
      }
      for (const childNode of Object.values(node.children)) {
        queue.push(childNode);
      }
    }
  }
};
var RegexMatcher = class {
  constructor(patterns) {
    this.patterns = patterns.map((p) => ({
      regex: new RegExp(p.pattern),
      replacements: p.replacements
    }));
  }
  addPattern(pattern) {
    this.patterns.push({
      regex: new RegExp(pattern.pattern),
      replacements: pattern.replacements
    });
  }
  getSuggestions(input) {
    const suggestions = [];
    let fastReplace = false;
    for (const pattern of this.patterns) {
      const matches = input.match(pattern.regex);
      if (matches) {
        for (const replacement of pattern.replacements) {
          let result = replacement;
          for (let i = 1; i < matches.length; i++) {
            result = result.replace(`$${i}`, matches[i] || "");
          }
          suggestions.push(result);
        }
      }
    }
    return { suggestions, fastReplace };
  }
};
var SuggestionMatcher = class {
  constructor(patterns) {
    const trieTerms = patterns.flatMap((conf) => {
      if (!conf.type) {
        return [{ term: conf.pattern, value: conf }];
      }
      return [];
    });
    this.trie = new Trie(trieTerms);
    const regexTerms = patterns.flatMap((conf) => {
      if (conf.type && conf.type === "regex") {
        return [conf];
      }
      return [];
    });
    this.regexes = new RegexMatcher(regexTerms);
  }
  replacePlaceholders(value, matches) {
    return value.replace(/\$([1-9]\d*)/g, (match, indexStr) => {
      const index = parseInt(indexStr, 10) - 1;
      if (index < matches.length) {
        return matches[index];
      }
      return match;
    });
  }
  getMatchingPatterns(searchString) {
    return this.trie.lookup(searchString);
  }
  getSuggestions(searchString) {
    const results = this.trie.lookup(searchString);
    const suggestions = [];
    let fastReplace = false;
    results.forEach(({ value: conf, match: wildcardMatches }) => {
      conf.replacements.forEach((replacement) => {
        const suggestion = this.replacePlaceholders(replacement, wildcardMatches);
        suggestions.push(suggestion);
      });
      fastReplace = fastReplace || !!conf.fastReplace;
    });
    const rs = this.regexes.getSuggestions(searchString);
    suggestions.push(...rs.suggestions);
    fastReplace = (fastReplace || rs.fastReplace) && suggestions.length === 1;
    return { suggestions, fastReplace };
  }
};

// config.ts
var DEFAULT_CONFIG = {
  renderMath: false,
  patterns: [
    { pattern: "or", replacements: ["\\lor"], fastReplace: true },
    { pattern: "and", replacements: ["\\land"], fastReplace: true },
    { pattern: "not", replacements: ["\\lnot"], fastReplace: true },
    { pattern: "=>", replacements: ["\\implies"], fastReplace: true },
    { pattern: "<=>", replacements: ["\\iff"], fastReplace: true },
    { pattern: "a", replacements: ["\\alpha", "\\aleph"] },
    { pattern: "b", replacements: ["\\beta", "\\beth"] },
    { pattern: "g", replacements: ["\\gamma", "\\gimel"] },
    { pattern: "d", replacements: ["\\delta", "\\daleth"] },
    { pattern: "e", replacements: ["\\epsilon", "\\varepsilon"] },
    { pattern: "z", replacements: ["\\zeta"] },
    { pattern: "h", replacements: ["\\eta"] },
    { pattern: "t", replacements: ["\\theta", "\\vartheta"] },
    { pattern: "i", replacements: ["\\iota"] },
    { pattern: "k", replacements: ["\\kappa"] },
    { pattern: "l", replacements: ["\\lambda"] },
    { pattern: "m", replacements: ["\\mu"] },
    { pattern: "n", replacements: ["\\nu"] },
    { pattern: "x", replacements: ["\\xi"] },
    { pattern: "o", replacements: ["\\omicron"] },
    { pattern: "p", replacements: ["\\pi", "\\varpi"] },
    { pattern: "r", replacements: ["\\rho", "\\varrho"] },
    { pattern: "s", replacements: ["\\sigma", "\\varsigma"] },
    { pattern: "u", replacements: ["\\upsilon"] },
    { pattern: "f", replacements: ["\\phi", "\\varphi"] },
    { pattern: "c", replacements: ["\\chi"] },
    { pattern: "y", replacements: ["\\psi"] },
    { pattern: "w", replacements: ["\\omega"] },
    { pattern: "E", replacements: ["\\exists"] },
    { pattern: "G", replacements: ["\\Gamma"] },
    { pattern: "D", replacements: ["\\Delta"] },
    { pattern: "T", replacements: ["\\Theta"] },
    { pattern: "I", replacements: ["\\Iota"] },
    { pattern: "L", replacements: ["\\Lambda"] },
    { pattern: "X", replacements: ["\\Xi"] },
    { pattern: "P", replacements: ["\\Pi"] },
    { pattern: "S", replacements: ["\\Sigma"] },
    { pattern: "U", replacements: ["\\Upsilon"] },
    { pattern: "F", replacements: ["\\Phi", "\\forall"] },
    { pattern: "Y", replacements: ["\\Psi"] },
    { pattern: "W", replacements: ["\\Omega"] },
    { pattern: "(", replacements: ["\\big(", "\\Big(", "\\bigg(", "\\Bigg("] },
    { pattern: ")", replacements: ["\\big)", "\\Big)", "\\bigg)", "\\Bigg)"] },
    { pattern: "[", replacements: ["\\big[", "\\Big[", "\\bigg[", "\\Bigg[", "\\lceil", "\\lfloor", "\\ulcorner", "\\llcorner"] },
    { pattern: "]", replacements: ["\\big]", "\\Big]", "\\bigg]", "\\Bigg]", "\\rceil", "\\rfloor", "\\urcorner", "\\lrcorner"] },
    { pattern: "->", replacements: ["\\rightarrow", "\\to"] },
    { pattern: "<-", replacements: ["\\leftarrow"] },
    { pattern: "<->", replacements: ["\\leftrightarrow"] },
    { pattern: "=>", replacements: ["\\implies"] },
    { pattern: "<=", replacements: ["\\leq"] },
    { pattern: ">=", replacements: ["\\geq"] },
    { pattern: "+", replacements: ["+"] },
    { pattern: "-", replacements: ["-"] },
    { pattern: "/", replacements: ["\\div"] },
    { pattern: "sum", replacements: ["\\sum"] },
    { pattern: "int", replacements: ["\\int"] },
    { pattern: "lim", replacements: ["\\lim"] },
    { pattern: "inf", replacements: ["\\infty"] },
    { pattern: "sqrt", replacements: ["\\sqrt"] },
    { pattern: "prod", replacements: ["\\prod"] },
    { pattern: "=", replacements: ["="] },
    { pattern: "!=", replacements: ["\\neq"] },
    { pattern: "~=", replacements: ["\\approx"] },
    { pattern: "~~", replacements: ["\\sim"] },
    { pattern: "<<", replacements: ["\\ll"] },
    { pattern: ">>", replacements: ["\\gg"] },
    { pattern: "in", replacements: ["\\in"], fastReplace: true },
    { pattern: "ni", replacements: ["\\ni"], fastReplace: true },
    { pattern: "subset", replacements: ["\\subset", "\\subseteq"] },
    { pattern: "supset", replacements: ["\\supset", "\\supseteq"] },
    { pattern: "empty", replacements: ["\\emptyset"], fastReplace: true },
    { pattern: "...", replacements: ["\\ldots"] },
    { pattern: "\xB0", replacements: ["\\degree"] },
    { pattern: "\xA3", replacements: ["\\pounds"] },
    { pattern: "$", replacements: ["\\$"] },
    { pattern: "%", replacements: ["\\%"] },
    { pattern: "&", replacements: ["\\&"] },
    { pattern: "hat", replacements: ["\\hat{}"] },
    { pattern: "bar", replacements: ["\\bar{}"] },
    { pattern: "tilde", replacements: ["\\tilde{}"] },
    { pattern: "vec", replacements: ["\\vec{}"] },
    { pattern: "sin", replacements: ["\\sin"], fastReplace: true },
    { pattern: "cos", replacements: ["\\cos"], fastReplace: true },
    { pattern: "tan", replacements: ["\\tan"], fastReplace: true },
    { pattern: "log", replacements: ["\\log"], fastReplace: true },
    { pattern: "ln", replacements: ["\\ln"], fastReplace: true },
    { pattern: "exp", replacements: ["\\exp"], fastReplace: true },
    { pattern: "frac", replacements: ["T:\\frac{$1}{$2}"] },
    { pattern: "binom", replacements: ["\\binom{}{}"] },
    { type: "regex", pattern: "(.*)_over$", replacements: ["\\overline{$1}"] },
    { pattern: "underline", replacements: ["\\underline{}"] },
    { pattern: "overset", replacements: ["\\overset{}{}}"] },
    { pattern: "underset", replacements: ["\\underset{}{}}"] },
    { pattern: "forall", replacements: ["\\forall"], fastReplace: true },
    { pattern: "exists", replacements: ["\\exists"], fastReplace: true },
    { pattern: "nexists", replacements: ["\\nexists"], fastReplace: true },
    { pattern: "aleph", replacements: ["\\aleph"] },
    { pattern: "hbar", replacements: ["\\hbar"] },
    { pattern: "ell", replacements: ["\\ell"] },
    { pattern: "Re", replacements: ["\\Re"] },
    { pattern: "Im", replacements: ["\\Im"] }
  ]
};
var ConfigManager = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  async saveConfig(config) {
    await this.plugin.saveData(config);
  }
  async loadConfig() {
    this.config = Object.assign({}, DEFAULT_CONFIG, await this.plugin.loadData());
    this.matcher = new SuggestionMatcher(this.config.patterns);
  }
  async updateConfig() {
    await this.saveConfig(this.config);
    this.matcher = new SuggestionMatcher(this.config.patterns);
  }
  async resetConfig() {
    this.config = DEFAULT_CONFIG;
    await this.updateConfig();
  }
};

// suggestion_popup.ts
var import_obsidian = __toModule(require("obsidian"));
var TEMPLATE_PREFIX = "T:";
var SuggestionPopup = class {
  constructor() {
    this.element = this.createElement();
    this.isVisible = false;
    this.currentMatch = null;
    this.currentReplacements = null;
    this.fastReplace = false;
    this.selectedIndex = -1;
    this.inputHandler = null;
    this.view = null;
    this.handleDocumentClick = this.handleDocumentClick.bind(this);
    this.handleKeyDown = this.handleKeyDown.bind(this);
    document.addEventListener("click", this.handleDocumentClick);
    document.addEventListener("keydown", this.handleKeyDown);
  }
  createElement() {
    const popup = document.createElement("div");
    popup.style.cssText = `
            position: absolute;
            background: var(--background-primary);
            border: 1px solid var(--background-modifier-border);
            padding: 2px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            display: none;
            white-space: nowrap;
            z-index: 10000;
        `;
    document.body.appendChild(popup);
    return popup;
  }
  show(x, y, match, replacements, inputHandler, fastReplace = false, view) {
    this.currentMatch = match;
    this.currentReplacements = replacements;
    this.selectedIndex = -1;
    this.inputHandler = inputHandler;
    this.fastReplace = fastReplace && replacements.length === 1;
    this.element.style.left = `${x + 5}px`;
    this.element.style.bottom = `${window.innerHeight - y}px`;
    this.element.style.top = "auto";
    this.element.style.display = "block";
    this.isVisible = true;
    this.view = view;
    this.updateContent(view);
  }
  hide() {
    this.element.style.display = "none";
    this.element.innerHTML = "";
    this.isVisible = false;
    this.selectedIndex = -1;
    this.currentMatch = null;
    this.currentReplacements = null;
    this.view = null;
  }
  updateContent(view) {
    if (!this.currentMatch || !this.currentReplacements)
      return;
    this.element.innerHTML = "";
    const styleElement = document.createElement("style");
    const cssRule = `
          p {
            display: inline;
            margin: 0;
            padding: 0;
          }
        `;
    styleElement.textContent = cssRule;
    this.element.appendChild(styleElement);
    this.currentReplacements.forEach((option, index) => {
      const appliedReplacement = option.startsWith(TEMPLATE_PREFIX) ? option.slice(TEMPLATE_PREFIX.length) : option;
      const span = document.createElement("span");
      span.id = `suggestion-${index}`;
      span.style.cssText = `
                cursor: pointer;
                padding: 5px;
                display: inline;
            `;
      span.addEventListener("mouseover", () => {
        if (index !== this.selectedIndex) {
          span.style.background = "var(--background-secondary)";
        }
      });
      span.addEventListener("mouseout", () => {
        if (index !== this.selectedIndex) {
          span.style.background = "var(--background-primary)";
        }
      });
      span.addEventListener("click", () => {
        this.selectSuggestion(index);
      });
      const indicatorSpan = document.createElement("span");
      if (this.fastReplace && this.currentReplacements.length === 1) {
        indicatorSpan.style.cssText = `
                    color: #22c55e;
                    margin-right: 2px;
                    font-size: 0.6em;
                `;
        indicatorSpan.textContent = "\u26A1";
      } else {
        indicatorSpan.style.cssText = `
                    font-size: 0.7em;
                    color: #888;
                    margin-right: 2px;
                `;
        indicatorSpan.textContent = `${index + 1}.`;
      }
      const mathSpan = document.createElement("span");
      span.appendChild(indicatorSpan);
      span.appendChild(mathSpan);
      this.element.appendChild(span);
      import_obsidian.MarkdownRenderer.renderMarkdown(`$${appliedReplacement}$`, mathSpan, view.file.path, view);
    });
  }
  updateSelectedSuggestion() {
    const suggestions = this.element.querySelectorAll('span[id^="suggestion-"]');
    suggestions.forEach((span) => {
      span.style.background = "var(--background-primary)";
    });
    if (this.selectedIndex >= 0) {
      const selectedSpan = this.element.querySelector(`#suggestion-${this.selectedIndex}`);
      if (selectedSpan) {
        selectedSpan.style.background = "var(--background-secondary)";
      }
    }
  }
  selectSuggestion(index) {
    if (!this.currentReplacements || !this.view)
      return;
    if (index >= 0 && index < this.currentReplacements.length) {
      const replacement = this.currentReplacements[index];
      if (replacement.startsWith(TEMPLATE_PREFIX)) {
        const form = new TemplateForm(replacement.slice(TEMPLATE_PREFIX.length), this.inputHandler);
        form.show();
      } else {
        const start = this.view.editor.offsetToPos(this.view.editor.posToOffset(this.view.editor.getCursor()) - this.currentMatch.length);
        this.view.editor.replaceRange(replacement, start, this.view.editor.getCursor());
      }
      this.hide();
    }
  }
  handleKeyDown(e) {
    if (!this.isVisible || !this.currentReplacements)
      return;
    if (this.fastReplace && !/^[a-zA-Z0-9]$/.test(e.key) && !["Escape", "Tab", "Backspace"].includes(e.key)) {
      this.selectSuggestion(0);
      return;
    }
    switch (e.key) {
      case "Escape":
        this.hide();
        e.preventDefault();
        break;
      case "Tab":
        e.preventDefault();
        if (this.selectedIndex < this.currentReplacements.length - 1) {
          this.selectedIndex++;
        } else {
          this.selectedIndex = 0;
        }
        this.updateSelectedSuggestion();
        break;
      case "Enter":
        if (this.selectedIndex >= 0) {
          e.preventDefault();
          this.selectSuggestion(this.selectedIndex);
        }
        break;
      default:
        if (e.key >= "1" && e.key <= "9") {
          const index = parseInt(e.key) - 1;
          if (index < this.currentReplacements.length) {
            this.selectSuggestion(index);
            e.preventDefault();
          }
        }
    }
  }
  handleDocumentClick(e) {
    if (this.isVisible && !this.element.contains(e.target)) {
      this.hide();
    }
  }
  destroy() {
    document.removeEventListener("click", this.handleDocumentClick);
    document.removeEventListener("keydown", this.handleKeyDown);
    if (this.element && this.element.parentNode) {
      this.element.parentNode.removeChild(this.element);
    }
  }
};

// config_dialog.ts
var import_obsidian2 = __toModule(require("obsidian"));
var ConfigDialog = class extends import_obsidian2.Component {
  constructor(configManager, matchForm) {
    super();
    this.configManager = configManager;
    this.config = configManager.config;
    this.isVisible = false;
    this.matchForm = matchForm;
  }
  onload() {
    this.element = this.createElement();
    this.handleDocumentClick = this.handleDocumentClick.bind(this);
  }
  createElement() {
    const dialog = document.createElement("div");
    dialog.style.cssText = `
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--background-secondary);
            border: 1px solid var(--background-modifier-border-focus);
            border-radius: 4px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            display: none;
            z-index: 10002;
            max-width: 80%;
            max-height: 80%;
            width: auto;
            overflow-y: auto;
        `;
    document.body.appendChild(dialog);
    return dialog;
  }
  createEditButton(conf) {
    const button = document.createElement("button");
    button.innerHTML = "\u270F\uFE0F";
    button.style.cssText = `
            margin-left: 8px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 16px;
            padding: 2px 6px;
            border-radius: 4px;
            vertical-align: middle;
        `;
    button.title = "Edit pattern";
    this.registerDomEvent(button, "click", (e) => {
      e.stopPropagation();
      this.matchForm.show(conf);
      this.hide();
    });
    return button;
  }
  show(selectedText) {
    this.element.innerHTML = "";
    const title = document.createElement("h2");
    title.innerHTML = `Matching Patterns for <code>${selectedText}</code>`;
    this.element.appendChild(title);
    const matches = this.configManager.matcher.getMatchingPatterns(selectedText);
    for (const { value, wildcardMatches } of matches) {
      const { pattern, replacements, fastReplace } = value;
      const patternDiv = document.createElement("div");
      const patternHeader = document.createElement("h3");
      patternHeader.style.display = "flex";
      patternHeader.style.alignItems = "center";
      if (fastReplace && replacements.length === 1) {
        const fastReplaceIcon = document.createElement("span");
        fastReplaceIcon.style.cssText = `
                    color: #22c55e;
                    margin-right: 8px;
                `;
        fastReplaceIcon.title = "Fast Replace Enabled";
        fastReplaceIcon.textContent = "\u26A1";
        patternHeader.appendChild(fastReplaceIcon);
      }
      const patternText = document.createElement("span");
      patternText.innerHTML = `Pattern: <code>${pattern}</code>`;
      patternHeader.appendChild(patternText);
      patternHeader.appendChild(this.createEditButton(value));
      patternDiv.appendChild(patternHeader);
      const replacementsList = document.createElement("ul");
      replacementsList.innerHTML = replacements.map((r) => {
        const rendered = (() => {
          if (r.startsWith("T:")) {
            return r.slice(2);
          } else {
            return this.configManager.matcher.replacePlaceholders(r, wildcardMatches);
          }
        })();
        return `<li>$${rendered}$ <code>[${r}]</code></li>`;
      }).join("");
      patternDiv.appendChild(replacementsList);
      this.element.appendChild(patternDiv);
      window.MathJax.typesetPromise([patternDiv]);
    }
    if (matches.length === 0) {
      const noMatch = document.createElement("p");
      noMatch.textContent = "No matching patterns found.";
      this.element.appendChild(noMatch);
    }
    const closeButton = document.createElement("button");
    closeButton.textContent = "Close";
    closeButton.onclick = () => {
      this.hide();
    };
    this.element.appendChild(closeButton);
    this.element.style.display = "block";
    this.isVisible = true;
  }
  hide() {
    this.element.style.display = "none";
    this.isVisible = false;
  }
  handleDocumentClick(e) {
    if (this.isVisible && !this.element.contains(e.target)) {
      this.hide();
    }
  }
};

// selection_button.ts
var import_obsidian3 = __toModule(require("obsidian"));
var SelectionButton = class extends import_obsidian3.Component {
  constructor(configManager, configDialog, matchForm) {
    super();
    this.configManager = configManager;
    this.selectionTimeout = null;
    this.configDialog = configDialog;
    this.hasMatch = false;
    this.matchForm = matchForm;
  }
  onload() {
    this.element = this.createElement();
    this.attachEventListeners();
  }
  createElement() {
    const button = document.createElement("button");
    button.style.cssText = `
            position: absolute;
            display: none;
            border: 1px solid #ccc;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            z-index: 10001;
            font-size: 16px;
            line-height: 24px;
            text-align: center;
            padding: 0;
        `;
    document.body.appendChild(button);
    return button;
  }
  attachEventListeners() {
    this.registerDomEvent(this.element, "click", () => {
      var _a, _b, _c;
      const selectedText = (_b = (_a = window.getSelection()) == null ? void 0 : _a.toString().trim()) != null ? _b : "";
      if (this.hasMatch) {
        this.configDialog.show(selectedText);
      } else {
        this.matchForm.show({ pattern: selectedText, replacements: [] });
      }
      (_c = window.getSelection()) == null ? void 0 : _c.empty();
      this.hide();
    });
    this.registerDomEvent(document, "keyup", () => {
      this.hide();
    });
    this.registerDomEvent(document, "mouseup", () => {
      this.handleSelection();
    });
  }
  show(x, y) {
    this.element.style.left = `${x}px`;
    this.element.style.top = `${y}px`;
    this.element.style.display = "block";
  }
  hide() {
    this.element.style.display = "none";
  }
  handleSelection() {
    if (this.selectionTimeout) {
      clearTimeout(this.selectionTimeout);
    }
    this.selectionTimeout = window.setTimeout(() => {
      var _a;
      const selection = window.getSelection();
      const selectedText = (_a = selection == null ? void 0 : selection.toString().trim()) != null ? _a : "";
      if (selectedText.length > 0) {
        this.hasMatch = this.configManager.matcher.getMatchingPatterns(selectedText).length > 0;
        this.updateButtonAppearance();
        const range = selection == null ? void 0 : selection.getRangeAt(0);
        const rect = range == null ? void 0 : range.getBoundingClientRect();
        if (rect) {
          this.show(rect.right + window.pageXOffset, rect.top + window.pageYOffset);
        }
      } else {
        this.hide();
      }
    }, 70);
  }
  updateButtonAppearance() {
    if (this.hasMatch) {
      this.element.textContent = "\u2699\uFE0F";
      this.element.title = "View matching patterns";
    } else {
      this.element.textContent = "+";
      this.element.title = "Add new pattern";
    }
  }
};

// match_form.ts
var import_obsidian4 = __toModule(require("obsidian"));
var MatchForm = class extends import_obsidian4.Component {
  constructor(configManager) {
    super();
    this.configManager = configManager;
  }
  onload() {
    this.element = this.createElement();
  }
  createElement() {
    const form = document.createElement("div");
    form.style.cssText = `
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--background-primary);
            border: 1px solid var(--background-modifier-border);
            border-radius: 4px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 10003;
            max-width: 80%;
            max-height: 80%;
            overflow-y: auto;
            display: none;
        `;
    document.body.appendChild(form);
    return form;
  }
  updateContent() {
    var _a;
    const fastReplaceHtml = `
            <div class="fast-replace-section" style="margin-top: 15px; margin-bottom: 15px;">
                <label style="display: flex; align-items: center; gap: 8px;">
                    <input type="checkbox" id="fastReplace" ${((_a = this.matchData) == null ? void 0 : _a.fastReplace) ? "checked" : ""}>
                    <span style="display: flex; align-items: center;">
                        Fast Replace
                        <span style="color: #22c55e; margin-left: 4px;">\u26A1</span>
                    </span>
                </label>
                <div style="font-size: 0.8em; color: #666; margin-top: 4px;">
                    Enables quick replacement with any non-alphanumeric character
                </div>
            </div>
        `;
    this.element.innerHTML = `
            <h2>${this.matchData ? "Edit Pattern" : "Create New Pattern"}</h2>
            <label for="pattern">Pattern (regex):</label>
            <input type="text" id="pattern" value="${this.matchData ? this.matchData.pattern : ""}"><br><br>
            ${fastReplaceHtml}
            <div id="replacements"></div>
            <button id="addReplacement">Add Replacement</button><br><br>
            <button id="saveMatch">Save</button>
            <button id="cancelMatch">Cancel</button>
        `;
    if (this.matchData) {
      this.matchData.replacements.forEach((replacement) => {
        const isTemplate = replacement.startsWith("T:");
        const actualReplacement = isTemplate ? replacement.slice(2) : replacement;
        this.addReplacementField(actualReplacement, isTemplate);
      });
    } else {
      this.addReplacementField();
    }
    this.attachEventListeners();
  }
  attachEventListeners() {
    const addReplacementButton = this.element.querySelector("#addReplacement");
    const saveMatchButton = this.element.querySelector("#saveMatch");
    const cancelMatchButton = this.element.querySelector("#cancelMatch");
    if (addReplacementButton && saveMatchButton && cancelMatchButton) {
      addReplacementButton.addEventListener("click", () => {
        this.addReplacementField();
        this.updateFastReplaceState();
      });
      saveMatchButton.addEventListener("click", () => this.saveMatch());
      cancelMatchButton.addEventListener("click", () => this.hide());
    }
  }
  updateFastReplaceState() {
    const fastReplaceCheckbox = this.element.querySelector("#fastReplace");
    const replacements = this.element.querySelectorAll("#replacements fieldset");
    if (fastReplaceCheckbox) {
      if (replacements.length > 1) {
        fastReplaceCheckbox.checked = false;
        fastReplaceCheckbox.disabled = true;
        fastReplaceCheckbox.title = "Fast replace is only available for patterns with a single replacement";
      } else {
        fastReplaceCheckbox.disabled = false;
        fastReplaceCheckbox.title = "";
      }
    }
  }
  addReplacementField(replacement = "", isTemplate = false) {
    const replacementsDiv = this.element.querySelector("#replacements");
    if (!replacementsDiv)
      return;
    const fieldSet = document.createElement("fieldset");
    fieldSet.style.cssText = `
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        `;
    fieldSet.innerHTML = `
            <div style="display: flex; align-items: center; gap: 10px;">
                <div style="flex-grow: 1;">
                    <label for="replacement">Replacement:</label>
                    <input type="text" class="replacement" value="${replacement}" style="width: 100%;">
                </div>
                <div>
                    <label style="display: flex; align-items: center; gap: 4px;">
                        <input type="checkbox" class="template-checkbox" ${isTemplate ? "checked" : ""}>
                        Template
                    </label>
                </div>
                <button class="removeReplacement" style="margin-left: auto;">Remove</button>
            </div>
        `;
    const removeButton = fieldSet.querySelector(".removeReplacement");
    if (removeButton) {
      removeButton.addEventListener("click", () => {
        fieldSet.remove();
        this.updateFastReplaceState();
      });
    }
    replacementsDiv.appendChild(fieldSet);
  }
  saveMatch() {
    const patternInput = this.element.querySelector("#pattern");
    const fastReplaceCheckbox = this.element.querySelector("#fastReplace");
    const replacementFieldsets = this.element.querySelectorAll("#replacements fieldset");
    if (!patternInput)
      return;
    const pattern = patternInput.value;
    const replacements = Array.from(replacementFieldsets).map((fieldset) => {
      const replacementInput = fieldset.querySelector(".replacement");
      const templateCheckbox = fieldset.querySelector(".template-checkbox");
      const replacementValue = (replacementInput == null ? void 0 : replacementInput.value) || "";
      const isTemplate = (templateCheckbox == null ? void 0 : templateCheckbox.checked) || false;
      return isTemplate ? `T:${replacementValue}` : replacementValue;
    });
    const fastReplace = (fastReplaceCheckbox == null ? void 0 : fastReplaceCheckbox.checked) || false;
    if (this.matchData) {
      const oldPatternIndex = this.configManager.config.patterns.findIndex((p) => p.pattern === this.matchData.pattern);
      if (oldPatternIndex !== -1) {
        this.configManager.config.patterns.splice(oldPatternIndex, 1);
      }
    }
    this.configManager.config.patterns.push({
      pattern,
      replacements,
      fastReplace
    });
    this.configManager.updateConfig();
    this.hide();
  }
  show(matchData = null) {
    this.matchData = matchData;
    this.updateContent();
    this.element.style.display = "block";
  }
  hide() {
    this.element.style.display = "none";
    this.element.innerHTML = "";
  }
};

// config_view.ts
var import_obsidian5 = __toModule(require("obsidian"));
var CONFIG_VIEW_TYPE = "config-reference-view";
var ConfigView = class extends import_obsidian5.ItemView {
  constructor(leaf, configManager) {
    super(leaf);
    this.configManager = configManager;
  }
  getViewType() {
    return CONFIG_VIEW_TYPE;
  }
  getDisplayText() {
    return "LaTeX Shortcuts Reference";
  }
  async onOpen() {
    const container = this.containerEl.children[1];
    container.empty();
    const headerContainer = container.createEl("div", { cls: "config-view-header" });
    headerContainer.style.display = "flex";
    headerContainer.style.justifyContent = "space-between";
    headerContainer.style.alignItems = "center";
    headerContainer.style.marginBottom = "20px";
    headerContainer.createEl("h2", { text: "LaTeX Shortcuts Reference" });
    const closeButton = headerContainer.createEl("button", { cls: "config-view-close" });
    closeButton.style.cssText = `
            padding: 4px 8px;
            cursor: pointer;
            border-radius: 4px;
            border: 1px solid var(--background-modifier-border);
            background: var(--background-primary);
        `;
    closeButton.setText("\u2715");
    closeButton.addEventListener("click", () => {
      closeButton.addEventListener("click", () => {
        this.app.workspace.detachLeavesOfType(CONFIG_VIEW_TYPE);
      });
    });
    const searchContainer = container.createEl("div", { cls: "search-container" });
    searchContainer.style.margin = "10px 0";
    const searchInput = searchContainer.createEl("input", {
      type: "text",
      placeholder: "Search patterns..."
    });
    searchInput.style.width = "100%";
    searchInput.style.padding = "5px";
    const patternsContainer = container.createEl("div", { cls: "patterns-container" });
    const categories = this.groupPatternsByCategory(this.configManager.config.patterns);
    const renderPatterns = (searchTerm = "") => {
      patternsContainer.empty();
      for (const [category, patterns] of Object.entries(categories)) {
        const filteredPatterns = patterns.filter((pattern) => pattern.pattern.toLowerCase().includes(searchTerm.toLowerCase()) || pattern.replacements.some((r) => r.toLowerCase().includes(searchTerm.toLowerCase())));
        if (filteredPatterns.length === 0)
          continue;
        const categoryEl = patternsContainer.createEl("div", { cls: "category" });
        categoryEl.style.marginBottom = "20px";
        categoryEl.createEl("h3", { text: category });
        const table = categoryEl.createEl("table");
        table.style.width = "100%";
        table.style.borderCollapse = "collapse";
        const thead = table.createEl("thead");
        const headerRow = thead.createEl("tr");
        ["Pattern", "Preview", "LaTeX"].forEach((header) => {
          const th = headerRow.createEl("th");
          th.style.textAlign = "left";
          th.style.padding = "8px";
          th.style.borderBottom = "1px solid var(--background-modifier-border)";
          th.setText(header);
        });
        const tbody = table.createEl("tbody");
        filteredPatterns.forEach((pattern) => {
          pattern.replacements.forEach((replacement, idx) => {
            var _a;
            const row = tbody.createEl("tr");
            const patternCell = row.createEl("td");
            patternCell.style.padding = "8px";
            patternCell.style.verticalAlign = "middle";
            if (idx === 0) {
              if (pattern.fastReplace) {
                const icon = patternCell.createEl("span");
                icon.style.cssText = `
                                    color: #22c55e;
                                    margin-right: 4px;
                                    font-size: 0.8em;
                                `;
                icon.setAttribute("title", "Fast Replace Enabled");
                icon.setText("\u26A1");
              }
              patternCell.createEl("code", { text: pattern.pattern });
            }
            patternCell.style.borderBottom = idx === pattern.replacements.length - 1 ? "2px solid var(--background-modifier-border-focus)" : "1px solid var(--background-modifier-border)";
            const previewCell = row.createEl("td");
            previewCell.style.padding = "8px";
            previewCell.style.verticalAlign = "middle";
            previewCell.style.borderBottom = patternCell.style.borderBottom;
            const cleanReplacement = replacement.startsWith("T:") ? replacement.slice(2) : replacement;
            import_obsidian5.MarkdownRenderer.renderMarkdown(`$${cleanReplacement}$`, previewCell, ((_a = this.leaf.view.file) == null ? void 0 : _a.path) || "", this);
            const latexCell = row.createEl("td");
            latexCell.style.padding = "8px";
            latexCell.style.verticalAlign = "middle";
            latexCell.style.borderBottom = patternCell.style.borderBottom;
            latexCell.createEl("code", { text: replacement });
          });
        });
      }
    };
    searchInput.addEventListener("input", (e) => {
      const searchTerm = e.target.value;
      renderPatterns(searchTerm);
    });
    renderPatterns();
  }
  groupPatternsByCategory(patterns) {
    const categories = {
      "Logical Operators": [],
      "Greek Letters": [],
      "Mathematical Operators": [],
      "Set Symbols": [],
      "Arrows": [],
      "Functions": [],
      "Parentheses": [],
      "Other": []
    };
    patterns.forEach((pattern) => {
      if (pattern.replacements.some((r) => r.includes("\\lor") || r.includes("\\land") || r.includes("\\lnot"))) {
        categories["Logical Operators"].push(pattern);
      } else if (pattern.replacements.some((r) => r.includes("\\alpha") || r.includes("\\beta") || r.includes("\\gamma"))) {
        categories["Greek Letters"].push(pattern);
      } else if (pattern.replacements.some((r) => r.includes("\\sum") || r.includes("\\prod") || r.includes("\\int"))) {
        categories["Mathematical Operators"].push(pattern);
      } else if (pattern.replacements.some((r) => r.includes("\\in") || r.includes("\\subset"))) {
        categories["Set Symbols"].push(pattern);
      } else if (pattern.replacements.some((r) => r.includes("\\rightarrow") || r.includes("\\leftarrow"))) {
        categories["Arrows"].push(pattern);
      } else if (pattern.replacements.some((r) => r.includes("\\sin") || r.includes("\\cos") || r.includes("\\log"))) {
        categories["Functions"].push(pattern);
      } else if (pattern.replacements.some((r) => r.includes("\\big") || r.includes("\\Big"))) {
        categories["Parentheses"].push(pattern);
      } else {
        categories["Other"].push(pattern);
      }
    });
    Object.keys(categories).forEach((key) => {
      if (categories[key].length === 0) {
        delete categories[key];
      }
    });
    return categories;
  }
};

// main.ts
var WordPopupPlugin = class extends import_obsidian6.Plugin {
  async onload() {
    this.configManager = new ConfigManager(this);
    await this.configManager.loadConfig();
    this.suggestionPopup = new SuggestionPopup();
    this.matchForm = new MatchForm(this.configManager);
    this.configDialog = new ConfigDialog(this.configManager, this.matchForm);
    this.selectionButton = new SelectionButton(this.configManager, this.configDialog, this.matchForm);
    this.addChild(this.selectionButton);
    this.addChild(this.configDialog);
    this.addChild(this.matchForm);
    this.registerEvent(this.app.workspace.on("editor-change", (editor, view) => {
      this.handleEditorChange(editor, view);
    }));
    this.registerView(CONFIG_VIEW_TYPE, (leaf) => new ConfigView(leaf, this.configManager));
    this.addRibbonIcon("book-open", "Open LaTeX Reference", async () => {
      const { workspace } = this.app;
      let leaf = workspace.getLeavesOfType(CONFIG_VIEW_TYPE)[0];
      if (!leaf) {
        leaf = workspace.getRightLeaf(false);
        await leaf.setViewState({
          type: CONFIG_VIEW_TYPE,
          active: true
        });
      }
      workspace.revealLeaf(leaf);
    });
    console.log("Plugin Loaded");
  }
  onunload() {
    this.suggestionPopup.destroy();
  }
  async handleEditorChange(editor, view) {
    const cursor = editor.getCursor();
    const line = editor.getLine(cursor.line);
    const wordUnderCursor = this.getWordUnderCursor(line, cursor.ch);
    const suggestions = this.configManager.matcher.getSuggestions(wordUnderCursor);
    if (suggestions.suggestions.length > 0) {
      const coords = editor.coordsAtPos(cursor);
      if (!coords)
        return;
      this.suggestionPopup.show(coords.left, coords.top, wordUnderCursor, suggestions.suggestions, null, suggestions.fastReplace, view);
    } else {
      this.suggestionPopup.hide();
    }
  }
  hasUnclosedMathSection(str) {
    let inMathMode = false;
    let isDoubleDollar = false;
    for (let i = 0; i < str.length; i++) {
      if (str[i] === "\\" && i + 1 < str.length && str[i + 1] === "$") {
        i++;
        continue;
      }
      if (str[i] === "$" && i + 1 < str.length && str[i + 1] === "$") {
        if (!inMathMode) {
          inMathMode = true;
          isDoubleDollar = true;
          i++;
        } else if (isDoubleDollar) {
          inMathMode = false;
          isDoubleDollar = false;
          i++;
        }
        continue;
      }
      if (str[i] === "$") {
        if (!inMathMode) {
          inMathMode = true;
          isDoubleDollar = false;
        } else if (!isDoubleDollar) {
          inMathMode = false;
        }
      }
    }
    return inMathMode;
  }
  getWordUnderCursor(lineStr, cursorPos) {
    if (!this.hasUnclosedMathSection(lineStr.slice(0, cursorPos))) {
      return "";
    }
    let i = lineStr.length - 1;
    while (i >= 0) {
      if (lineStr[i] == "$" || lineStr[i] == " ") {
        i += 1;
        break;
      } else {
        i -= 1;
      }
    }
    if (i <= 0) {
      return lineStr;
    }
    return lineStr.substr(i);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJwYXR0ZXJuX21hdGNoZXIudHMiLCAiY29uZmlnLnRzIiwgInN1Z2dlc3Rpb25fcG9wdXAudHMiLCAiY29uZmlnX2RpYWxvZy50cyIsICJzZWxlY3Rpb25fYnV0dG9uLnRzIiwgIm1hdGNoX2Zvcm0udHMiLCAiY29uZmlnX3ZpZXcudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7XG4gICAgQXBwLFxuICAgIEVkaXRvcixcbiAgICBNYXJrZG93blZpZXcsXG4gICAgUGx1Z2luLFxuICAgIFBvaW50LFxuICAgIEVkaXRvclBvc2l0aW9uLFxuICAgIE1hcmtkb3duUmVuZGVyZXJcbn0gZnJvbSAnb2JzaWRpYW4nO1xuXG5pbXBvcnQgeyBDb25maWdNYW5hZ2VyIH0gZnJvbSBcIi4vY29uZmlnXCJcbmltcG9ydCB7IFN1Z2dlc3Rpb25Qb3B1cCB9IGZyb20gXCIuL3N1Z2dlc3Rpb25fcG9wdXBcIlxuaW1wb3J0IHsgQ29uZmlnRGlhbG9nIH0gZnJvbSBcIi4vY29uZmlnX2RpYWxvZ1wiXG5pbXBvcnQgeyBTZWxlY3Rpb25CdXR0b24gfSBmcm9tIFwiLi9zZWxlY3Rpb25fYnV0dG9uXCJcbmltcG9ydCB7IE1hdGNoRm9ybSB9IGZyb20gXCIuL21hdGNoX2Zvcm1cIlxuaW1wb3J0IHsgQ09ORklHX1ZJRVdfVFlQRSwgQ29uZmlnVmlldyB9IGZyb20gJy4vY29uZmlnX3ZpZXcnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBXb3JkUG9wdXBQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIGNvbmZpZ01hbmFnZXI6IENvbmZpZ01hbmFnZXI7XG4gICAgc3VnZ2VzdGlvblBvcHVwOiBTdWdnZXN0aW9uUG9wdXA7XG4gICAgc2VsZWN0aW9uQnV0dG9uOiBTZWxlY3Rpb25CdXR0b247XG4gICAgY29uZmlnRGlhbG9nOiBDb25maWdEaWFsb2c7XG4gICAgbWF0Y2hGb3JtOiBNYXRjaEZvcm07XG4gICAgcG9wdXBFbDogSFRNTEVsZW1lbnQ7XG4gICAgY29udGVudEVsOiBIVE1MRWxlbWVudDtcblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgdGhpcy5jb25maWdNYW5hZ2VyID0gbmV3IENvbmZpZ01hbmFnZXIodGhpcyk7XG4gICAgICAgIGF3YWl0IHRoaXMuY29uZmlnTWFuYWdlci5sb2FkQ29uZmlnKCk7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvblBvcHVwID0gbmV3IFN1Z2dlc3Rpb25Qb3B1cCgpO1xuICAgICAgICB0aGlzLm1hdGNoRm9ybSA9IG5ldyBNYXRjaEZvcm0odGhpcy5jb25maWdNYW5hZ2VyKTtcbiAgICAgICAgdGhpcy5jb25maWdEaWFsb2cgPSBuZXcgQ29uZmlnRGlhbG9nKHRoaXMuY29uZmlnTWFuYWdlciwgdGhpcy5tYXRjaEZvcm0pO1xuICAgICAgICB0aGlzLnNlbGVjdGlvbkJ1dHRvbiA9IG5ldyBTZWxlY3Rpb25CdXR0b24odGhpcy5jb25maWdNYW5hZ2VyLCB0aGlzLmNvbmZpZ0RpYWxvZywgdGhpcy5tYXRjaEZvcm0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ2hpbGQodGhpcy5zZWxlY3Rpb25CdXR0b24pO1xuICAgICAgICB0aGlzLmFkZENoaWxkKHRoaXMuY29uZmlnRGlhbG9nKTtcbiAgICAgICAgdGhpcy5hZGRDaGlsZCh0aGlzLm1hdGNoRm9ybSk7XG5cblxuICAgICAgICAvLyBSZWdpc3RlciBlZGl0b3IgY2hhbmdlIGV2ZW50XG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbignZWRpdG9yLWNoYW5nZScsIChlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVFZGl0b3JDaGFuZ2UoZWRpdG9yLCB2aWV3KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5yZWdpc3RlclZpZXcoXG4gICAgICAgICAgICBDT05GSUdfVklFV19UWVBFLFxuICAgICAgICAgICAgKGxlYWYpID0+IG5ldyBDb25maWdWaWV3KGxlYWYsIHRoaXMuY29uZmlnTWFuYWdlcilcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBBZGQgYSByaWJib24gaWNvbiB0byBhY3RpdmF0ZSB0aGUgdmlld1xuICAgICAgICB0aGlzLmFkZFJpYmJvbkljb24oJ2Jvb2stb3BlbicsICdPcGVuIExhVGVYIFJlZmVyZW5jZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgd29ya3NwYWNlIH0gPSB0aGlzLmFwcDtcblxuICAgICAgICAgICAgLy8gSWYgdGhlIHZpZXcgaXMgYWxyZWFkeSBvcGVuLCBzaG93IGl0XG4gICAgICAgICAgICBsZXQgbGVhZiA9IHdvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoQ09ORklHX1ZJRVdfVFlQRSlbMF07XG5cbiAgICAgICAgICAgIGlmICghbGVhZikge1xuICAgICAgICAgICAgICAgIC8vIElmIGl0J3Mgbm90IG9wZW4sIGNyZWF0ZSBhIG5ldyBsZWFmIGFuZCBzaG93IHRoZSB2aWV3XG4gICAgICAgICAgICAgICAgbGVhZiA9IHdvcmtzcGFjZS5nZXRSaWdodExlYWYoZmFsc2UpO1xuICAgICAgICAgICAgICAgIGF3YWl0IGxlYWYuc2V0Vmlld1N0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogQ09ORklHX1ZJRVdfVFlQRSxcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3b3Jrc3BhY2UucmV2ZWFsTGVhZihsZWFmKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc29sZS5sb2coXCJQbHVnaW4gTG9hZGVkXCIpO1xuICAgIH1cblxuICAgIG9udW5sb2FkKCkge1xuICAgICAgICB0aGlzLnN1Z2dlc3Rpb25Qb3B1cC5kZXN0cm95KCk7XG4gICAgfVxuXG4gICAgYXN5bmMgaGFuZGxlRWRpdG9yQ2hhbmdlKGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpIHtcbiAgICAgICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgICAgICBjb25zdCBsaW5lID0gZWRpdG9yLmdldExpbmUoY3Vyc29yLmxpbmUpO1xuICAgICAgICBjb25zdCB3b3JkVW5kZXJDdXJzb3IgPSB0aGlzLmdldFdvcmRVbmRlckN1cnNvcihsaW5lLCBjdXJzb3IuY2gpO1xuXG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gdGhpcy5jb25maWdNYW5hZ2VyLm1hdGNoZXIuZ2V0U3VnZ2VzdGlvbnMod29yZFVuZGVyQ3Vyc29yKTtcblxuICAgICAgICBpZiAoc3VnZ2VzdGlvbnMuc3VnZ2VzdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgY29vcmRzID0gZWRpdG9yLmNvb3Jkc0F0UG9zKGN1cnNvcik7XG4gICAgICAgICAgICBpZiAoIWNvb3JkcykgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuc2hvdyhcbiAgICAgICAgICAgICAgICBjb29yZHMubGVmdCxcbiAgICAgICAgICAgICAgICBjb29yZHMudG9wLFxuICAgICAgICAgICAgICAgIHdvcmRVbmRlckN1cnNvcixcbiAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5zdWdnZXN0aW9ucyxcbiAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25zLmZhc3RSZXBsYWNlLFxuICAgICAgICAgICAgICAgIHZpZXcsXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zdWdnZXN0aW9uUG9wdXAuaGlkZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaGFzVW5jbG9zZWRNYXRoU2VjdGlvbihzdHIpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IGluTWF0aE1vZGUgPSBmYWxzZTtcbiAgICAgICAgbGV0IGlzRG91YmxlRG9sbGFyID0gZmFsc2U7XG5cbiAgICAgICAgLy8gUHJvY2VzcyBzdHJpbmcgY2hhcmFjdGVyIGJ5IGNoYXJhY3RlclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgLy8gSGFuZGxlIGVzY2FwZWQgZG9sbGFyIHNpZ25zXG4gICAgICAgICAgICBpZiAoc3RyW2ldID09PSAnXFxcXCcgJiYgaSArIDEgPCBzdHIubGVuZ3RoICYmIHN0cltpICsgMV0gPT09ICckJykge1xuICAgICAgICAgICAgICAgIGkrKzsgLy8gU2tpcCB0aGUgZXNjYXBlZCBkb2xsYXIgc2lnblxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgZG91YmxlIGRvbGxhciBzaWduc1xuICAgICAgICAgICAgaWYgKHN0cltpXSA9PT0gJyQnICYmIGkgKyAxIDwgc3RyLmxlbmd0aCAmJiBzdHJbaSArIDFdID09PSAnJCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWluTWF0aE1vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5NYXRoTW9kZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlzRG91YmxlRG9sbGFyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaSsrOyAvLyBTa2lwIHNlY29uZCBkb2xsYXJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzRG91YmxlRG9sbGFyKSB7XG4gICAgICAgICAgICAgICAgICAgIGluTWF0aE1vZGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgaXNEb3VibGVEb2xsYXIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgaSsrOyAvLyBTa2lwIHNlY29uZCBkb2xsYXJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEhhbmRsZSBzaW5nbGUgZG9sbGFyIHNpZ25zXG4gICAgICAgICAgICBpZiAoc3RyW2ldID09PSAnJCcpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWluTWF0aE1vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5NYXRoTW9kZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlzRG91YmxlRG9sbGFyID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghaXNEb3VibGVEb2xsYXIpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5NYXRoTW9kZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5NYXRoTW9kZTtcbiAgICB9XG5cblxuICAgIGdldFdvcmRVbmRlckN1cnNvcihsaW5lU3RyOiBzdHJpbmcsIGN1cnNvclBvczogbnVtYmVyKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKCF0aGlzLmhhc1VuY2xvc2VkTWF0aFNlY3Rpb24obGluZVN0ci5zbGljZSgwLCBjdXJzb3JQb3MpKSkge1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG4gICAgICAgIGxldCBpID0gbGluZVN0ci5sZW5ndGggLSAxO1xuICAgICAgICB3aGlsZSAoaSA+PSAwKSB7XG4gICAgICAgICAgICBpZiAobGluZVN0cltpXSA9PSAnJCcgfHwgbGluZVN0cltpXSA9PSAnICcgKXtcbiAgICAgICAgICAgICAgICBpICs9IDE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGkgLT0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaTw9MCkge1xuICAgICAgICAgICAgcmV0dXJuIGxpbmVTdHI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxpbmVTdHIuc3Vic3RyKGkpO1xuICAgIH1cblxufVxuIiwgImltcG9ydCB7IFBhdHRlcm4gfSBmcm9tIFwiLi9jb25maWdcIlxuXG4vLyBJbnRlcmZhY2UgZm9yIHRyaWUgdGVybSBzdHJ1Y3R1cmVcbmludGVyZmFjZSBUcmllVGVybSB7XG4gICAgdGVybTogc3RyaW5nO1xuICAgIHZhbHVlOiBQYXR0ZXJuO1xufVxuXG4vLyBJbnRlcmZhY2UgZm9yIGxvb2t1cCByZXN1bHRzXG5pbnRlcmZhY2UgTG9va3VwUmVzdWx0IHtcbiAgICB2YWx1ZTogUGF0dGVybjtcbiAgICBtYXRjaDogc3RyaW5nW107XG59XG5cbi8vIEludGVyZmFjZSBmb3Igc3VnZ2VzdGlvbiByZXN1bHRzXG5pbnRlcmZhY2UgU3VnZ2VzdGlvblJlc3VsdCB7XG4gICAgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdO1xuICAgIGZhc3RSZXBsYWNlOiBib29sZWFuO1xufVxuXG5jbGFzcyBUcmllTm9kZSB7XG4gICAgY2hpbGRyZW46IHsgW2tleTogc3RyaW5nXTogVHJpZU5vZGUgfTtcbiAgICB2YWx1ZTogUGF0dGVybiB8IG51bGw7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5jaGlsZHJlbiA9IHt9O1xuICAgICAgICB0aGlzLnZhbHVlID0gbnVsbDtcbiAgICB9XG59XG5cbmNsYXNzIFRyaWUge1xuICAgIHByaXZhdGUgcm9vdDogVHJpZU5vZGU7XG5cbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RzIGFuIGltbXV0YWJsZSBUcmllLlxuICAgICAqIEBwYXJhbSB0ZXJtcyAtIEFycmF5IG9mIHRlcm1zIHdpdGggYXNzb2NpYXRlZCB2YWx1ZXMuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodGVybXM6IFRyaWVUZXJtW10pIHtcbiAgICAgICAgdGhpcy5yb290ID0gbmV3IFRyaWVOb2RlKCk7XG4gICAgICAgIGZvciAoY29uc3QgeyB0ZXJtLCB2YWx1ZSB9IG9mIHRlcm1zKSB7XG4gICAgICAgICAgICB0aGlzLmluc2VydCh0ZXJtLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbnNlcnRzIGEgdGVybSB3aXRoIGl0cyBhc3NvY2lhdGVkIHZhbHVlIGludG8gdGhlIHRyaWUuXG4gICAgICogQHBhcmFtIHRlcm0gLSBUaGUgdGVybSB0byBpbnNlcnQgKG1heSBjb250YWluIHdpbGRjYXJkcyAnKicpLlxuICAgICAqIEBwYXJhbSB2YWx1ZSAtIFRoZSB2YWx1ZSBhc3NvY2lhdGVkIHdpdGggdGhlIHRlcm0uXG4gICAgICovXG4gICAgcHJpdmF0ZSBpbnNlcnQodGVybTogc3RyaW5nLCB2YWx1ZTogUGF0dGVybik6IHZvaWQge1xuICAgICAgICBsZXQgbm9kZSA9IHRoaXMucm9vdDtcbiAgICAgICAgZm9yIChjb25zdCBjaGFyIG9mIHRlcm0pIHtcbiAgICAgICAgICAgIGlmICghbm9kZS5jaGlsZHJlbltjaGFyXSkge1xuICAgICAgICAgICAgICAgIG5vZGUuY2hpbGRyZW5bY2hhcl0gPSBuZXcgVHJpZU5vZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5vZGUgPSBub2RlLmNoaWxkcmVuW2NoYXJdO1xuICAgICAgICB9XG4gICAgICAgIG5vZGUudmFsdWUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb29rcyB1cCBhIHN0cmluZyBpbiB0aGUgdHJpZSwgbWF0Y2hpbmcgdGVybXMgdGhhdCBtYXkgY29udGFpbiB3aWxkY2FyZHMgJyonLlxuICAgICAqIENvbGxlY3RzIGFsbCBtYXRjaGluZyB2YWx1ZXMgYW5kIHRoZSBjaGFyYWN0ZXJzIG1hdGNoZWQgYnkgd2lsZGNhcmRzLlxuICAgICAqIEBwYXJhbSBxdWVyeSAtIFRoZSBzdHJpbmcgdG8gbG9vayB1cC5cbiAgICAgKiBAcmV0dXJucyBBbiBhcnJheSBvZiBtYXRjaGluZyByZXN1bHRzLlxuICAgICAqL1xuICAgIGxvb2t1cChxdWVyeTogc3RyaW5nKTogTG9va3VwUmVzdWx0W10ge1xuICAgICAgICBjb25zdCByZXN1bHRzOiBMb29rdXBSZXN1bHRbXSA9IFtdO1xuICAgICAgICBjb25zdCB2aXNpdGVkID0gbmV3IFNldDxUcmllTm9kZT4oKTtcblxuICAgICAgICB0aGlzLl9sb29rdXBIZWxwZXIodGhpcy5yb290LCBxdWVyeSwgMCwgcmVzdWx0cywgW10sIHZpc2l0ZWQpO1xuXG4gICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2xvb2t1cEhlbHBlcihcbiAgICAgICAgbm9kZTogVHJpZU5vZGUsXG4gICAgICAgIHF1ZXJ5OiBzdHJpbmcsXG4gICAgICAgIGluZGV4OiBudW1iZXIsXG4gICAgICAgIHJlc3VsdHM6IExvb2t1cFJlc3VsdFtdLFxuICAgICAgICB3aWxkY2FyZE1hdGNoZXM6IHN0cmluZ1tdLFxuICAgICAgICB2aXNpdGVkOiBTZXQ8VHJpZU5vZGU+XG4gICAgKTogdm9pZCB7XG4gICAgICAgIGlmIChpbmRleCA9PT0gcXVlcnkubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAobm9kZS52YWx1ZSAhPT0gbnVsbCAmJiAhdmlzaXRlZC5oYXMobm9kZSkpIHtcbiAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbm9kZS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2g6IHdpbGRjYXJkTWF0Y2hlcy5zbGljZSgpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZpc2l0ZWQuYWRkKG5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY2hhciA9IHF1ZXJ5W2luZGV4XTtcblxuICAgICAgICAvLyBGaXJzdCwgdHJ5IGV4YWN0IGNoYXJhY3RlciBtYXRjaFxuICAgICAgICBpZiAobm9kZS5jaGlsZHJlbltjaGFyXSkge1xuICAgICAgICAgICAgdGhpcy5fbG9va3VwSGVscGVyKFxuICAgICAgICAgICAgICAgIG5vZGUuY2hpbGRyZW5bY2hhcl0sXG4gICAgICAgICAgICAgICAgcXVlcnksXG4gICAgICAgICAgICAgICAgaW5kZXggKyAxLFxuICAgICAgICAgICAgICAgIHJlc3VsdHMsXG4gICAgICAgICAgICAgICAgd2lsZGNhcmRNYXRjaGVzLFxuICAgICAgICAgICAgICAgIHZpc2l0ZWRcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUaGVuLCB0cnkgd2lsZGNhcmQgbWF0Y2hcbiAgICAgICAgaWYgKGNoYXIubWF0Y2goL15bMC05YS16XSskLykgJiYgbm9kZS5jaGlsZHJlblsnKiddKSB7XG4gICAgICAgICAgICBjb25zdCBuZXdXaWxkY2FyZE1hdGNoZXMgPSB3aWxkY2FyZE1hdGNoZXMuY29uY2F0KGNoYXIpO1xuICAgICAgICAgICAgdGhpcy5fbG9va3VwSGVscGVyKFxuICAgICAgICAgICAgICAgIG5vZGUuY2hpbGRyZW5bJyonXSxcbiAgICAgICAgICAgICAgICBxdWVyeSxcbiAgICAgICAgICAgICAgICBpbmRleCArIDEsXG4gICAgICAgICAgICAgICAgcmVzdWx0cyxcbiAgICAgICAgICAgICAgICBuZXdXaWxkY2FyZE1hdGNoZXMsXG4gICAgICAgICAgICAgICAgdmlzaXRlZFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYWxsIHZhbHVlcyBvZiB0ZXJtcyB0aGF0IHN0YXJ0IHdpdGggdGhlIGdpdmVuIHF1ZXJ5IHN0cmluZy5cbiAgICAgKiBAcGFyYW0gcXVlcnkgLSBUaGUgcXVlcnkgc3RyaW5nLlxuICAgICAqIEByZXR1cm5zIEFuIGFycmF5IG9mIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggbWF0Y2hpbmcgdGVybXMuXG4gICAgICovXG4gICAgdHlwZUFoZWFkKHF1ZXJ5OiBzdHJpbmcpOiBQYXR0ZXJuW10ge1xuICAgICAgICBsZXQgbm9kZXMgPSBbeyBub2RlOiB0aGlzLnJvb3QsIGluZGV4OiAwIH1dO1xuICAgICAgICBjb25zdCByZXN1bHRzOiBQYXR0ZXJuW10gPSBbXTtcbiAgICAgICAgY29uc3QgY29sbGVjdGVkTm9kZXMgPSBuZXcgU2V0PFRyaWVOb2RlPigpO1xuXG4gICAgICAgIHdoaWxlIChub2Rlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBsZXQgbmV4dE5vZGVzID0gW107XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHsgbm9kZSwgaW5kZXggfSBvZiBub2Rlcykge1xuICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gcXVlcnkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbGxlY3RWYWx1ZXMobm9kZSwgcmVzdWx0cywgY29sbGVjdGVkTm9kZXMpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgPSBxdWVyeVtpbmRleF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlLmNoaWxkcmVuW2NoYXJdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0Tm9kZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZTogbm9kZS5jaGlsZHJlbltjaGFyXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleDogaW5kZXggKyAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYXIubWF0Y2goL15bMC05YS16XSskLykgJiYgbm9kZS5jaGlsZHJlblsnKiddKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0Tm9kZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZTogbm9kZS5jaGlsZHJlblsnKiddLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4OiBpbmRleCArIDEsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5vZGVzID0gbmV4dE5vZGVzO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfY29sbGVjdFZhbHVlcyhcbiAgICAgICAgc3RhcnROb2RlOiBUcmllTm9kZSxcbiAgICAgICAgcmVzdWx0czogUGF0dGVybltdLFxuICAgICAgICBjb2xsZWN0ZWROb2RlczogU2V0PFRyaWVOb2RlPlxuICAgICk6IHZvaWQge1xuICAgICAgICBsZXQgcXVldWUgPSBbc3RhcnROb2RlXTtcbiAgICAgICAgY29uc3QgdmlzaXRlZE5vZGVzID0gbmV3IFNldDxUcmllTm9kZT4oKTtcblxuICAgICAgICB3aGlsZSAocXVldWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IHF1ZXVlLnNoaWZ0KCkhO1xuXG4gICAgICAgICAgICBpZiAodmlzaXRlZE5vZGVzLmhhcyhub2RlKSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmlzaXRlZE5vZGVzLmFkZChub2RlKTtcblxuICAgICAgICAgICAgaWYgKG5vZGUudmFsdWUgIT09IG51bGwgJiYgIWNvbGxlY3RlZE5vZGVzLmhhcyhub2RlKSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChub2RlLnZhbHVlKTtcbiAgICAgICAgICAgICAgICBjb2xsZWN0ZWROb2Rlcy5hZGQobm9kZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGROb2RlIG9mIE9iamVjdC52YWx1ZXMobm9kZS5jaGlsZHJlbikpIHtcbiAgICAgICAgICAgICAgICBxdWV1ZS5wdXNoKGNoaWxkTm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNsYXNzIFJlZ2V4TWF0Y2hlciB7XG4gICAgcHJpdmF0ZSBwYXR0ZXJuczogeyByZWdleDogUmVnRXhwOyByZXBsYWNlbWVudHM6IHN0cmluZ1tdIH1bXTtcblxuICAgIGNvbnN0cnVjdG9yKHBhdHRlcm5zOiBQYXR0ZXJuW10pIHtcbiAgICAgICAgdGhpcy5wYXR0ZXJucyA9IHBhdHRlcm5zLm1hcCgocCkgPT4gKHtcbiAgICAgICAgICAgIHJlZ2V4OiBuZXcgUmVnRXhwKHAucGF0dGVybiksXG4gICAgICAgICAgICByZXBsYWNlbWVudHM6IHAucmVwbGFjZW1lbnRzLFxuICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgYWRkUGF0dGVybihwYXR0ZXJuOiBQYXR0ZXJuKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGF0dGVybnMucHVzaCh7XG4gICAgICAgICAgICByZWdleDogbmV3IFJlZ0V4cChwYXR0ZXJuLnBhdHRlcm4pLFxuICAgICAgICAgICAgcmVwbGFjZW1lbnRzOiBwYXR0ZXJuLnJlcGxhY2VtZW50cyxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZ2V0U3VnZ2VzdGlvbnMoaW5wdXQ6IHN0cmluZyk6IFN1Z2dlc3Rpb25SZXN1bHQge1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgbGV0IGZhc3RSZXBsYWNlID0gZmFsc2U7XG5cbiAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHRoaXMucGF0dGVybnMpIHtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBpbnB1dC5tYXRjaChwYXR0ZXJuLnJlZ2V4KTtcblxuICAgICAgICAgICAgaWYgKG1hdGNoZXMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHJlcGxhY2VtZW50IG9mIHBhdHRlcm4ucmVwbGFjZW1lbnRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCByZXN1bHQgPSByZXBsYWNlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBtYXRjaGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQucmVwbGFjZShgJCR7aX1gLCBtYXRjaGVzW2ldIHx8ICcnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgc3VnZ2VzdGlvbnMsIGZhc3RSZXBsYWNlIH07XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgU3VnZ2VzdGlvbk1hdGNoZXIge1xuICAgIHByaXZhdGUgdHJpZTogVHJpZTtcbiAgICBwcml2YXRlIHJlZ2V4ZXM6IFJlZ2V4TWF0Y2hlcjtcblxuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdHMgYSBTdWdnZXN0aW9uTWF0Y2hlci5cbiAgICAgKiBAcGFyYW0gcGF0dGVybnMgLSBBcnJheSBvZiBwYXR0ZXJuIG9iamVjdHMuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocGF0dGVybnM6IFBhdHRlcm5bXSkge1xuICAgICAgICBjb25zdCB0cmllVGVybXMgPSBwYXR0ZXJucy5mbGF0TWFwKChjb25mKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWNvbmYudHlwZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbeyB0ZXJtOiBjb25mLnBhdHRlcm4sIHZhbHVlOiBjb25mIH1dO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnRyaWUgPSBuZXcgVHJpZSh0cmllVGVybXMpO1xuXG4gICAgICAgIGNvbnN0IHJlZ2V4VGVybXMgPSBwYXR0ZXJucy5mbGF0TWFwKChjb25mKSA9PiB7XG4gICAgICAgICAgICBpZiAoY29uZi50eXBlICYmIGNvbmYudHlwZSA9PT0gJ3JlZ2V4Jykge1xuICAgICAgICAgICAgICAgIHJldHVybiBbY29uZl07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnJlZ2V4ZXMgPSBuZXcgUmVnZXhNYXRjaGVyKHJlZ2V4VGVybXMpO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVwbGFjZVBsYWNlaG9sZGVycyh2YWx1ZTogc3RyaW5nLCBtYXRjaGVzOiBzdHJpbmdbXSk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKC9cXCQoWzEtOV1cXGQqKS9nLCAobWF0Y2gsIGluZGV4U3RyKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IHBhcnNlSW50KGluZGV4U3RyLCAxMCkgLSAxO1xuICAgICAgICAgICAgaWYgKGluZGV4IDwgbWF0Y2hlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hlc1tpbmRleF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbWF0Y2g7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGdldE1hdGNoaW5nUGF0dGVybnMoc2VhcmNoU3RyaW5nOiBzdHJpbmcpOiBMb29rdXBSZXN1bHRbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRyaWUubG9va3VwKHNlYXJjaFN0cmluZyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGFrZXMgYSBzZWFyY2ggc3RyaW5nIGFzIGlucHV0IGFuZCByZXR1cm5zIGEgY29tYmluZWQgYXJyYXkgb2YgYWxsIHJlcGxhY2VtZW50c1xuICAgICAqIGZvciBhbGwgbWF0Y2hlcywgd2l0aCB0aGUgcGxhY2Vob2xkZXJzIHJlcGxhY2VkLlxuICAgICAqIEBwYXJhbSBzZWFyY2hTdHJpbmcgLSBUaGUgc2VhcmNoIHN0cmluZy5cbiAgICAgKiBAcmV0dXJucyBPYmplY3QgY29udGFpbmluZyBzdWdnZXN0aW9ucyBhcnJheSBhbmQgZmFzdFJlcGxhY2UgZmxhZy5cbiAgICAgKi9cbiAgICBnZXRTdWdnZXN0aW9ucyhzZWFyY2hTdHJpbmc6IHN0cmluZyk6IFN1Z2dlc3Rpb25SZXN1bHQge1xuICAgICAgICBjb25zdCByZXN1bHRzID0gdGhpcy50cmllLmxvb2t1cChzZWFyY2hTdHJpbmcpO1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgbGV0IGZhc3RSZXBsYWNlID0gZmFsc2U7XG5cbiAgICAgICAgcmVzdWx0cy5mb3JFYWNoKCh7IHZhbHVlOiBjb25mLCBtYXRjaDogd2lsZGNhcmRNYXRjaGVzIH0pID0+IHtcbiAgICAgICAgICAgIGNvbmYucmVwbGFjZW1lbnRzLmZvckVhY2goKHJlcGxhY2VtZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbiA9IHRoaXMucmVwbGFjZVBsYWNlaG9sZGVycyhcbiAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgIHdpbGRjYXJkTWF0Y2hlc1xuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgc3VnZ2VzdGlvbnMucHVzaChzdWdnZXN0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZmFzdFJlcGxhY2UgPSBmYXN0UmVwbGFjZSB8fCAhIWNvbmYuZmFzdFJlcGxhY2U7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHJzID0gdGhpcy5yZWdleGVzLmdldFN1Z2dlc3Rpb25zKHNlYXJjaFN0cmluZyk7XG4gICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goLi4ucnMuc3VnZ2VzdGlvbnMpO1xuICAgICAgICBmYXN0UmVwbGFjZSA9IChmYXN0UmVwbGFjZSB8fCBycy5mYXN0UmVwbGFjZSkgJiYgc3VnZ2VzdGlvbnMubGVuZ3RoID09PSAxO1xuXG4gICAgICAgIHJldHVybiB7IHN1Z2dlc3Rpb25zLCBmYXN0UmVwbGFjZSB9O1xuICAgIH1cbn1cbiIsICJpbXBvcnQge1xuICAgIFBsdWdpbixcbn0gZnJvbSAnb2JzaWRpYW4nO1xuXG5pbXBvcnQgeyBTdWdnZXN0aW9uTWF0Y2hlciB9IGZyb20gXCIuL3BhdHRlcm5fbWF0Y2hlclwiXG5cblxuXG5leHBvcnQgaW50ZXJmYWNlIFBhdHRlcm4ge1xuICAgIHR5cGU/OiAncmVnZXgnO1xuICAgIHBhdHRlcm46IHN0cmluZztcbiAgICByZXBsYWNlbWVudHM6IHN0cmluZ1tdO1xufVxuXG5pbnRlcmZhY2UgTWF0aENvbmZpZyB7XG4gICAgcmVuZGVyTWF0aDogYm9vbGVhbjtcbiAgICBwYXR0ZXJuczogUGF0dGVybltdO1xufVxuXG5jb25zdCBERUZBVUxUX0NPTkZJRzogTWF0aENvbmZpZyA9IHtcbiAgICByZW5kZXJNYXRoOiBmYWxzZSxcbiAgICBwYXR0ZXJucyA6IFtcbiAgICAgICAgLy8gTG9naWNhbCBvcGVyYXRvcnNcbiAgICAgICAgeyBwYXR0ZXJuOiAnb3InLCByZXBsYWNlbWVudHM6IFsnXFxcXGxvciddLCBmYXN0UmVwbGFjZTogdHJ1ZSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdhbmQnLCByZXBsYWNlbWVudHM6IFsnXFxcXGxhbmQnXSwgZmFzdFJlcGxhY2U6IHRydWUgfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnbm90JywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxsbm90J10sIGZhc3RSZXBsYWNlOiB0cnVlIH0sXG4gICAgICAgIHsgcGF0dGVybjogJz0+JywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxpbXBsaWVzJ10sIGZhc3RSZXBsYWNlOiB0cnVlIH0sXG4gICAgICAgIHsgcGF0dGVybjogJzw9PicsIHJlcGxhY2VtZW50czogWydcXFxcaWZmJ10sIGZhc3RSZXBsYWNlOiB0cnVlIH0sXG5cbiAgICAgICAgLy8gR3JlZWsgbGV0dGVyc1xuICAgICAgICB7IHBhdHRlcm46ICdhJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxhbHBoYScsICdcXFxcYWxlcGgnXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdiJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxiZXRhJywgJ1xcXFxiZXRoJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnZycsIHJlcGxhY2VtZW50czogWydcXFxcZ2FtbWEnLCAnXFxcXGdpbWVsJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnZCcsIHJlcGxhY2VtZW50czogWydcXFxcZGVsdGEnLCAnXFxcXGRhbGV0aCddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ2UnLCByZXBsYWNlbWVudHM6IFsnXFxcXGVwc2lsb24nLCAnXFxcXHZhcmVwc2lsb24nXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICd6JywgcmVwbGFjZW1lbnRzOiBbJ1xcXFx6ZXRhJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnaCcsIHJlcGxhY2VtZW50czogWydcXFxcZXRhJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAndCcsIHJlcGxhY2VtZW50czogWydcXFxcdGhldGEnLCAnXFxcXHZhcnRoZXRhJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnaScsIHJlcGxhY2VtZW50czogWydcXFxcaW90YSddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ2snLCByZXBsYWNlbWVudHM6IFsnXFxcXGthcHBhJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnbCcsIHJlcGxhY2VtZW50czogWydcXFxcbGFtYmRhJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnbScsIHJlcGxhY2VtZW50czogWydcXFxcbXUnXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICduJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxudSddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ3gnLCByZXBsYWNlbWVudHM6IFsnXFxcXHhpJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnbycsIHJlcGxhY2VtZW50czogWydcXFxcb21pY3JvbiddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ3AnLCByZXBsYWNlbWVudHM6IFsnXFxcXHBpJywgJ1xcXFx2YXJwaSddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ3InLCByZXBsYWNlbWVudHM6IFsnXFxcXHJobycsICdcXFxcdmFycmhvJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAncycsIHJlcGxhY2VtZW50czogWydcXFxcc2lnbWEnLCAnXFxcXHZhcnNpZ21hJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAndScsIHJlcGxhY2VtZW50czogWydcXFxcdXBzaWxvbiddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ2YnLCByZXBsYWNlbWVudHM6IFsnXFxcXHBoaScsICdcXFxcdmFycGhpJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnYycsIHJlcGxhY2VtZW50czogWydcXFxcY2hpJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAneScsIHJlcGxhY2VtZW50czogWydcXFxccHNpJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAndycsIHJlcGxhY2VtZW50czogWydcXFxcb21lZ2EnXSB9LFxuXG4gICAgICAgIC8vIFVwcGVyY2FzZSBHcmVlayBsZXR0ZXJzXG4gICAgICAgIHsgcGF0dGVybjogJ0UnLCByZXBsYWNlbWVudHM6IFsnXFxcXGV4aXN0cyddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ0cnLCByZXBsYWNlbWVudHM6IFsnXFxcXEdhbW1hJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnRCcsIHJlcGxhY2VtZW50czogWydcXFxcRGVsdGEnXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdUJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxUaGV0YSddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ0knLCByZXBsYWNlbWVudHM6IFsnXFxcXElvdGEnXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdMJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxMYW1iZGEnXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdYJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxYaSddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ1AnLCByZXBsYWNlbWVudHM6IFsnXFxcXFBpJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnUycsIHJlcGxhY2VtZW50czogWydcXFxcU2lnbWEnXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdVJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxVcHNpbG9uJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnRicsIHJlcGxhY2VtZW50czogWydcXFxcUGhpJywgJ1xcXFxmb3JhbGwnXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdZJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxQc2knXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdXJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxPbWVnYSddIH0sXG5cbiAgICAgICAgLy8gUGFyZW50aGVzZXMgYW5kIGJyYWNrZXRzXG4gICAgICAgIHsgcGF0dGVybjogJygnLCByZXBsYWNlbWVudHM6IFsnXFxcXGJpZygnLCAnXFxcXEJpZygnLCAnXFxcXGJpZ2coJywgJ1xcXFxCaWdnKCddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJyknLCByZXBsYWNlbWVudHM6IFsnXFxcXGJpZyknLCAnXFxcXEJpZyknLCAnXFxcXGJpZ2cpJywgJ1xcXFxCaWdnKSddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ1snLCByZXBsYWNlbWVudHM6IFsnXFxcXGJpZ1snLCAnXFxcXEJpZ1snLCAnXFxcXGJpZ2dbJywgJ1xcXFxCaWdnWycsICdcXFxcbGNlaWwnLCAnXFxcXGxmbG9vcicsICdcXFxcdWxjb3JuZXInLCAnXFxcXGxsY29ybmVyJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnXScsIHJlcGxhY2VtZW50czogWydcXFxcYmlnXScsICdcXFxcQmlnXScsICdcXFxcYmlnZ10nLCAnXFxcXEJpZ2ddJywgJ1xcXFxyY2VpbCcsICdcXFxccmZsb29yJywgJ1xcXFx1cmNvcm5lcicsICdcXFxcbHJjb3JuZXInXSB9LFxuXG4gICAgICAgIC8vIEFycm93c1xuICAgICAgICB7IHBhdHRlcm46ICctPicsIHJlcGxhY2VtZW50czogWydcXFxccmlnaHRhcnJvdycsICdcXFxcdG8nXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICc8LScsIHJlcGxhY2VtZW50czogWydcXFxcbGVmdGFycm93J10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnPC0+JywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxsZWZ0cmlnaHRhcnJvdyddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJz0+JywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxpbXBsaWVzJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnPD0nLCByZXBsYWNlbWVudHM6IFsnXFxcXGxlcSddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJz49JywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxnZXEnXSB9LFxuXG4gICAgICAgIC8vIE1hdGhlbWF0aWNhbCBvcGVyYXRvcnNcbiAgICAgICAgeyBwYXR0ZXJuOiAnKycsIHJlcGxhY2VtZW50czogWycrJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnLScsIHJlcGxhY2VtZW50czogWyctJ10gfSxcbiAgICAgICAgLy97IHBhdHRlcm46ICcqJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFx0aW1lcycsICdcXFxcYXN0J10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnLycsIHJlcGxhY2VtZW50czogWydcXFxcZGl2J10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnc3VtJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxzdW0nXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdpbnQnLCByZXBsYWNlbWVudHM6IFsnXFxcXGludCddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ2xpbScsIHJlcGxhY2VtZW50czogWydcXFxcbGltJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnaW5mJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxpbmZ0eSddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ3NxcnQnLCByZXBsYWNlbWVudHM6IFsnXFxcXHNxcnQnXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdwcm9kJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxwcm9kJ10gfSxcblxuICAgICAgICAvLyBSZWxhdGlvbmFsIG9wZXJhdG9yc1xuICAgICAgICB7IHBhdHRlcm46ICc9JywgcmVwbGFjZW1lbnRzOiBbJz0nXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICchPScsIHJlcGxhY2VtZW50czogWydcXFxcbmVxJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnfj0nLCByZXBsYWNlbWVudHM6IFsnXFxcXGFwcHJveCddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ35+JywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxzaW0nXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICc8PCcsIHJlcGxhY2VtZW50czogWydcXFxcbGwnXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICc+PicsIHJlcGxhY2VtZW50czogWydcXFxcZ2cnXSB9LFxuXG4gICAgICAgIC8vIFNldCBzeW1ib2xzXG4gICAgICAgIHsgcGF0dGVybjogJ2luJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxpbiddLCBmYXN0UmVwbGFjZTogdHJ1ZSB9LFxuICAgICAgICB7IHBhdHRlcm46ICduaScsIHJlcGxhY2VtZW50czogWydcXFxcbmknXSwgZmFzdFJlcGxhY2U6IHRydWUgfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnc3Vic2V0JywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxzdWJzZXQnLCAnXFxcXHN1YnNldGVxJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnc3Vwc2V0JywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxzdXBzZXQnLCAnXFxcXHN1cHNldGVxJ119LFxuICAgICAgICB7IHBhdHRlcm46ICdlbXB0eScsIHJlcGxhY2VtZW50czogWydcXFxcZW1wdHlzZXQnXSwgZmFzdFJlcGxhY2U6IHRydWUgfSxcblxuICAgICAgICAvLyBNaXNjZWxsYW5lb3VzIHN5bWJvbHNcbiAgICAgICAgeyBwYXR0ZXJuOiAnLi4uJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxsZG90cyddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ1x1MDBCMCcsIHJlcGxhY2VtZW50czogWydcXFxcZGVncmVlJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnXHUwMEEzJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxwb3VuZHMnXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICckJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFwkJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnJScsIHJlcGxhY2VtZW50czogWydcXFxcJSddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJyYnLCByZXBsYWNlbWVudHM6IFsnXFxcXCYnXSB9LFxuXG4gICAgICAgIC8vIEFjY2VudHNcbiAgICAgICAgeyBwYXR0ZXJuOiAnaGF0JywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxoYXR7fSddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ2JhcicsIHJlcGxhY2VtZW50czogWydcXFxcYmFye30nXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICd0aWxkZScsIHJlcGxhY2VtZW50czogWydcXFxcdGlsZGV7fSddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ3ZlYycsIHJlcGxhY2VtZW50czogWydcXFxcdmVje30nXSB9LFxuXG4gICAgICAgIC8vIENvbW1vbiBmdW5jdGlvbnNcbiAgICAgICAgeyBwYXR0ZXJuOiAnc2luJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxzaW4nXSwgZmFzdFJlcGxhY2U6IHRydWUgfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnY29zJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxjb3MnXSwgZmFzdFJlcGxhY2U6IHRydWUgfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAndGFuJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFx0YW4nXSwgZmFzdFJlcGxhY2U6IHRydWUgfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnbG9nJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxsb2cnXSwgZmFzdFJlcGxhY2U6IHRydWUgfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnbG4nLCByZXBsYWNlbWVudHM6IFsnXFxcXGxuJ10sIGZhc3RSZXBsYWNlOiB0cnVlIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ2V4cCcsIHJlcGxhY2VtZW50czogWydcXFxcZXhwJ10sIGZhc3RSZXBsYWNlOiB0cnVlIH0sXG5cbiAgICAgICAgLy8gRnJhY3Rpb25zIGFuZCBiaW5vbWlhbHNcbiAgICAgICAgeyBwYXR0ZXJuOiAnZnJhYycsIHJlcGxhY2VtZW50czogWydUOlxcXFxmcmFjeyQxfXskMn0nXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdiaW5vbScsIHJlcGxhY2VtZW50czogWydcXFxcYmlub217fXt9J10gfSxcblxuICAgICAgICAvLyBPdmVyIGFuZCB1bmRlciBzeW1ib2xzXG4gICAgICAgIHsgdHlwZTogJ3JlZ2V4JywgcGF0dGVybjogJyguKilfb3ZlciQnLCByZXBsYWNlbWVudHM6IFsnXFxcXG92ZXJsaW5leyQxfSddIH0sXG4gICAgICAgIHsgcGF0dGVybjogJ3VuZGVybGluZScsIHJlcGxhY2VtZW50czogWydcXFxcdW5kZXJsaW5le30nXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdvdmVyc2V0JywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxvdmVyc2V0e317fX0nXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICd1bmRlcnNldCcsIHJlcGxhY2VtZW50czogWydcXFxcdW5kZXJzZXR7fXt9fSddIH0sXG5cbiAgICAgICAgLy8gTG9naWNhbCBxdWFudGlmaWVyc1xuICAgICAgICB7IHBhdHRlcm46ICdmb3JhbGwnLCByZXBsYWNlbWVudHM6IFsnXFxcXGZvcmFsbCddLCBmYXN0UmVwbGFjZTogdHJ1ZSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdleGlzdHMnLCByZXBsYWNlbWVudHM6IFsnXFxcXGV4aXN0cyddLCBmYXN0UmVwbGFjZTogdHJ1ZSB9LFxuICAgICAgICB7IHBhdHRlcm46ICduZXhpc3RzJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxuZXhpc3RzJ10sIGZhc3RSZXBsYWNlOiB0cnVlIH0sXG5cbiAgICAgICAgLy8gTWlzY2VsbGFuZW91c1xuICAgICAgICB7IHBhdHRlcm46ICdhbGVwaCcsIHJlcGxhY2VtZW50czogWydcXFxcYWxlcGgnXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdoYmFyJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxoYmFyJ10gfSxcbiAgICAgICAgeyBwYXR0ZXJuOiAnZWxsJywgcmVwbGFjZW1lbnRzOiBbJ1xcXFxlbGwnXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdSZScsIHJlcGxhY2VtZW50czogWydcXFxcUmUnXSB9LFxuICAgICAgICB7IHBhdHRlcm46ICdJbScsIHJlcGxhY2VtZW50czogWydcXFxcSW0nXSB9LFxuICAgIF1cbn07XG5cbmV4cG9ydCBjbGFzcyBDb25maWdNYW5hZ2VyIHtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogUGx1Z2luKSB7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgc2F2ZUNvbmZpZyhjb25maWc6IENvbmZpZykge1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YShjb25maWcpO1xuICAgIH1cblxuICAgIGFzeW5jIGxvYWRDb25maWcoKSB7XG4gICAgICAgIHRoaXMuY29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcsIGF3YWl0IHRoaXMucGx1Z2luLmxvYWREYXRhKCkpO1xuICAgICAgICB0aGlzLm1hdGNoZXIgPSBuZXcgU3VnZ2VzdGlvbk1hdGNoZXIodGhpcy5jb25maWcucGF0dGVybnMpO1xuICAgIH1cblxuICAgIGFzeW5jIHVwZGF0ZUNvbmZpZygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29uZmlnKHRoaXMuY29uZmlnKTtcbiAgICAgICAgdGhpcy5tYXRjaGVyID0gbmV3IFN1Z2dlc3Rpb25NYXRjaGVyKHRoaXMuY29uZmlnLnBhdHRlcm5zKTtcbiAgICB9XG5cbiAgICBhc3luYyByZXNldENvbmZpZygpIHtcbiAgICAgICAgdGhpcy5jb25maWcgPSBERUZBVUxUX0NPTkZJRztcbiAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVDb25maWcoKTtcbiAgICB9XG5cblxufVxuIiwgIi8vaW1wb3J0IHsgVGVtcGxhdGVGb3JtIH0gZnJvbSBcIi4vdGVtcGxhdGVfZm9ybVwiO1xuXG5pbXBvcnQge1xuICAgIE1hcmtkb3duUmVuZGVyZXIsXG4gICAgTWFya2Rvd25WaWV3LFxufSBmcm9tICdvYnNpZGlhbic7XG5cbmNvbnN0IFRFTVBMQVRFX1BSRUZJWCA9IFwiVDpcIjtcblxuLy8gSW50ZXJmYWNlIGZvciB0aGUgaW5wdXQgaGFuZGxlclxuaW50ZXJmYWNlIElucHV0SGFuZGxlciB7XG4gICAgcmVwbGFjZUN1cnNvclRleHQ6ICh0ZXh0OiBzdHJpbmcpID0+IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBTdWdnZXN0aW9uUG9wdXAge1xuICAgIHByaXZhdGUgZWxlbWVudDogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBpc1Zpc2libGU6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBjdXJyZW50TWF0Y2g6IHN0cmluZyB8IG51bGw7XG4gICAgcHJpdmF0ZSBjdXJyZW50UmVwbGFjZW1lbnRzOiBzdHJpbmdbXSB8IG51bGw7XG4gICAgcHJpdmF0ZSBmYXN0UmVwbGFjZTogYm9vbGVhbjtcbiAgICBwcml2YXRlIHNlbGVjdGVkSW5kZXg6IG51bWJlcjtcbiAgICBwcml2YXRlIGlucHV0SGFuZGxlcjogSW5wdXRIYW5kbGVyIHwgbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLmNyZWF0ZUVsZW1lbnQoKTtcbiAgICAgICAgdGhpcy5pc1Zpc2libGUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jdXJyZW50TWF0Y2ggPSBudWxsO1xuICAgICAgICB0aGlzLmN1cnJlbnRSZXBsYWNlbWVudHMgPSBudWxsO1xuICAgICAgICB0aGlzLmZhc3RSZXBsYWNlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IC0xO1xuICAgICAgICB0aGlzLmlucHV0SGFuZGxlciA9IG51bGw7XG4gICAgICAgIHRoaXMudmlldyA9IG51bGw7XG5cbiAgICAgICAgLy8gQmluZCBtZXRob2RzIHRoYXQgYXJlIHVzZWQgYXMgZXZlbnQgaGFuZGxlcnNcbiAgICAgICAgdGhpcy5oYW5kbGVEb2N1bWVudENsaWNrID0gdGhpcy5oYW5kbGVEb2N1bWVudENsaWNrLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuaGFuZGxlS2V5RG93biA9IHRoaXMuaGFuZGxlS2V5RG93bi5iaW5kKHRoaXMpO1xuXG4gICAgICAgIC8vIEFkZCBnbG9iYWwgZXZlbnQgbGlzdGVuZXJzXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVEb2N1bWVudENsaWNrKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5RG93bik7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVFbGVtZW50KCk6IEhUTUxEaXZFbGVtZW50IHtcbiAgICAgICAgY29uc3QgcG9wdXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgcG9wdXAuc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG4gICAgICAgICAgICBwYWRkaW5nOiAycHg7XG4gICAgICAgICAgICBib3gtc2hhZG93OiAwIDJweCAxMHB4IHJnYmEoMCwwLDAsMC4yKTtcbiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7XG4gICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICAgICAgICAgICAgei1pbmRleDogMTAwMDA7XG4gICAgICAgIGA7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocG9wdXApO1xuICAgICAgICByZXR1cm4gcG9wdXA7XG4gICAgfVxuXG4gICAgc2hvdyh4OiBudW1iZXIsIHk6IG51bWJlciwgbWF0Y2g6IHN0cmluZywgcmVwbGFjZW1lbnRzOiBzdHJpbmdbXSwgaW5wdXRIYW5kbGVyOiBJbnB1dEhhbmRsZXIsIGZhc3RSZXBsYWNlID0gZmFsc2UsIHZpZXc6IE1hcmtkb3duVmlldyk6IHZvaWQge1xuICAgICAgICB0aGlzLmN1cnJlbnRNYXRjaCA9IG1hdGNoO1xuICAgICAgICB0aGlzLmN1cnJlbnRSZXBsYWNlbWVudHMgPSByZXBsYWNlbWVudHM7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IC0xO1xuICAgICAgICB0aGlzLmlucHV0SGFuZGxlciA9IGlucHV0SGFuZGxlcjtcbiAgICAgICAgdGhpcy5mYXN0UmVwbGFjZSA9IGZhc3RSZXBsYWNlICYmIHJlcGxhY2VtZW50cy5sZW5ndGggPT09IDE7XG4gICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5sZWZ0ID0gYCR7eCArIDV9cHhgO1xuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUuYm90dG9tID0gYCR7d2luZG93LmlubmVySGVpZ2h0IC0geX1weGA7XG4gICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS50b3AgPSAnYXV0byc7XG4gICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgdGhpcy5pc1Zpc2libGUgPSB0cnVlO1xuICAgICAgICB0aGlzLnZpZXcgPSB2aWV3O1xuXG4gICAgICAgIHRoaXMudXBkYXRlQ29udGVudCh2aWV3KTtcbiAgICB9XG5cbiAgICBoaWRlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9ICcnO1xuICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSAtMTtcbiAgICAgICAgdGhpcy5jdXJyZW50TWF0Y2ggPSBudWxsO1xuICAgICAgICB0aGlzLmN1cnJlbnRSZXBsYWNlbWVudHMgPSBudWxsO1xuICAgICAgICB0aGlzLnZpZXcgPSBudWxsO1xuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlQ29udGVudCh2aWV3OiBNYXJrZG93blZpZXcpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRNYXRjaCB8fCAhdGhpcy5jdXJyZW50UmVwbGFjZW1lbnRzKSByZXR1cm47XG4gICAgICAgIHRoaXMuZWxlbWVudC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgY29uc3Qgc3R5bGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcblxuICAgICAgICAvLyBEZWZpbmUgdGhlIENTUyBydWxlXG4gICAgICAgIGNvbnN0IGNzc1J1bGUgPSBgXG4gICAgICAgICAgcCB7XG4gICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmU7XG4gICAgICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgICAgICBwYWRkaW5nOiAwO1xuICAgICAgICAgIH1cbiAgICAgICAgYDtcblxuICAgICAgICAvLyBBZGQgdGhlIENTUyBydWxlIHRvIHRoZSBzdHlsZSBlbGVtZW50XG4gICAgICAgIHN0eWxlRWxlbWVudC50ZXh0Q29udGVudCA9IGNzc1J1bGU7XG5cbiAgICAgICAgLy8gSW5zZXJ0IHRoZSBzdHlsZSBlbGVtZW50IGFzIHRoZSBmaXJzdCBjaGlsZCBvZiB0aGUgZGl2XG4gICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChzdHlsZUVsZW1lbnQpO1xuXG4gICAgICAgIHRoaXMuY3VycmVudFJlcGxhY2VtZW50cy5mb3JFYWNoKChvcHRpb24sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBhcHBsaWVkUmVwbGFjZW1lbnQgPSBvcHRpb24uc3RhcnRzV2l0aChURU1QTEFURV9QUkVGSVgpXG4gICAgICAgICAgICAgICAgPyBvcHRpb24uc2xpY2UoVEVNUExBVEVfUFJFRklYLmxlbmd0aClcbiAgICAgICAgICAgICAgICA6IG9wdGlvbjtcblxuICAgICAgICAgICAgY29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICAgIHNwYW4uaWQgPSBgc3VnZ2VzdGlvbi0ke2luZGV4fWA7XG4gICAgICAgICAgICBzcGFuLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDVweDtcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmU7XG4gICAgICAgICAgICBgO1xuXG4gICAgICAgICAgICBzcGFuLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggIT09IHRoaXMuc2VsZWN0ZWRJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1zZWNvbmRhcnkpJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgc3Bhbi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggIT09IHRoaXMuc2VsZWN0ZWRJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnN0eWxlLmJhY2tncm91bmQgPSAndmFyKC0tYmFja2dyb3VuZC1wcmltYXJ5KSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHNwYW4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RTdWdnZXN0aW9uKGluZGV4KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBDcmVhdGUgaW5kaWNhdG9yIHNwYW5cbiAgICAgICAgICAgIGNvbnN0IGluZGljYXRvclNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5mYXN0UmVwbGFjZSAmJiB0aGlzLmN1cnJlbnRSZXBsYWNlbWVudHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgaW5kaWNhdG9yU3Bhbi5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogIzIyYzU1ZTtcbiAgICAgICAgICAgICAgICAgICAgbWFyZ2luLXJpZ2h0OiAycHg7XG4gICAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC42ZW07XG4gICAgICAgICAgICAgICAgYDtcbiAgICAgICAgICAgICAgICBpbmRpY2F0b3JTcGFuLnRleHRDb250ZW50ID0gJ1x1MjZBMSc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGluZGljYXRvclNwYW4uc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAwLjdlbTtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICM4ODg7XG4gICAgICAgICAgICAgICAgICAgIG1hcmdpbi1yaWdodDogMnB4O1xuICAgICAgICAgICAgICAgIGA7XG4gICAgICAgICAgICAgICAgaW5kaWNhdG9yU3Bhbi50ZXh0Q29udGVudCA9IGAke2luZGV4ICsgMX0uYDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ3JlYXRlIG1hdGggY29udGVudCBzcGFuXG4gICAgICAgICAgICBjb25zdCBtYXRoU3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcblxuICAgICAgICAgICAgc3Bhbi5hcHBlbmRDaGlsZChpbmRpY2F0b3JTcGFuKTtcbiAgICAgICAgICAgIHNwYW4uYXBwZW5kQ2hpbGQobWF0aFNwYW4pO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHNwYW4pO1xuICAgICAgICAgICAgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihcbiAgICAgICAgICAgICAgICBgJCR7YXBwbGllZFJlcGxhY2VtZW50fSRgLFxuICAgICAgICAgICAgICAgIG1hdGhTcGFuLFxuICAgICAgICAgICAgICAgIHZpZXcuZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgIHZpZXdcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFR5cGVTY3JpcHQgZG9lc24ndCBrbm93IGFib3V0IE1hdGhKYXggYnkgZGVmYXVsdCwgc28gd2UgbmVlZCB0byBkZWNsYXJlIGl0XG4gICAgICAgIC8vKHdpbmRvdyBhcyBhbnkpLk1hdGhKYXgudHlwZXNldFByb21pc2UoW3RoaXMuZWxlbWVudF0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlU2VsZWN0ZWRTdWdnZXN0aW9uKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9ucyA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsPEhUTUxTcGFuRWxlbWVudD4oJ3NwYW5baWRePVwic3VnZ2VzdGlvbi1cIl0nKTtcbiAgICAgICAgc3VnZ2VzdGlvbnMuZm9yRWFjaChzcGFuID0+IHtcbiAgICAgICAgICAgIHNwYW4uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpJztcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRJbmRleCA+PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZFNwYW4gPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MU3BhbkVsZW1lbnQ+KGAjc3VnZ2VzdGlvbi0ke3RoaXMuc2VsZWN0ZWRJbmRleH1gKTtcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZFNwYW4pIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RlZFNwYW4uc3R5bGUuYmFja2dyb3VuZCA9ICd2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSknO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZWxlY3RTdWdnZXN0aW9uKGluZGV4OiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRSZXBsYWNlbWVudHMgfHwgIXRoaXMudmlldykgcmV0dXJuO1xuXG4gICAgICAgIGlmIChpbmRleCA+PSAwICYmIGluZGV4IDwgdGhpcy5jdXJyZW50UmVwbGFjZW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnQgPSB0aGlzLmN1cnJlbnRSZXBsYWNlbWVudHNbaW5kZXhdO1xuICAgICAgICAgICAgaWYgKHJlcGxhY2VtZW50LnN0YXJ0c1dpdGgoVEVNUExBVEVfUFJFRklYKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm0gPSBuZXcgVGVtcGxhdGVGb3JtKHJlcGxhY2VtZW50LnNsaWNlKFRFTVBMQVRFX1BSRUZJWC5sZW5ndGgpLCB0aGlzLmlucHV0SGFuZGxlcik7XG4gICAgICAgICAgICAgICAgZm9ybS5zaG93KCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gdGhpcy52aWV3LmVkaXRvci5vZmZzZXRUb1BvcyhcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3LmVkaXRvci5wb3NUb09mZnNldCh0aGlzLnZpZXcuZWRpdG9yLmdldEN1cnNvcigpKSAtIHRoaXMuY3VycmVudE1hdGNoLmxlbmd0aFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3LmVkaXRvci5yZXBsYWNlUmFuZ2UocmVwbGFjZW1lbnQsIHN0YXJ0LCB0aGlzLnZpZXcuZWRpdG9yLmdldEN1cnNvcigpKTtcbiAgICAgICAgICAgICAgICAvL3RoaXMuaW5wdXRIYW5kbGVyLnJlcGxhY2VDdXJzb3JUZXh0KHJlcGxhY2VtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVLZXlEb3duKGU6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzVmlzaWJsZSB8fCAhdGhpcy5jdXJyZW50UmVwbGFjZW1lbnRzKSByZXR1cm47XG5cbiAgICAgICAgLy8gSGFuZGxlIGZhc3QgcmVwbGFjZSBmb3Igbm9uLWFscGhhbnVtZXJpYyBrZXlzXG4gICAgICAgIGlmICh0aGlzLmZhc3RSZXBsYWNlICYmXG4gICAgICAgICAgICAhL15bYS16QS1aMC05XSQvLnRlc3QoZS5rZXkpICYmXG4gICAgICAgICAgICAhWydFc2NhcGUnLCAnVGFiJywgJ0JhY2tzcGFjZSddLmluY2x1ZGVzKGUua2V5KSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RTdWdnZXN0aW9uKDApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgc3dpdGNoIChlLmtleSkge1xuICAgICAgICAgICAgY2FzZSAnRXNjYXBlJzpcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJ1RhYic6XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkSW5kZXggPCB0aGlzLmN1cnJlbnRSZXBsYWNlbWVudHMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXgrKztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGVkU3VnZ2VzdGlvbigpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdFbnRlcic6XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRJbmRleCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RTdWdnZXN0aW9uKHRoaXMuc2VsZWN0ZWRJbmRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGlmIChlLmtleSA+PSAnMScgJiYgZS5rZXkgPD0gJzknKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gcGFyc2VJbnQoZS5rZXkpIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4IDwgdGhpcy5jdXJyZW50UmVwbGFjZW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RTdWdnZXN0aW9uKGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaGFuZGxlRG9jdW1lbnRDbGljayhlOiBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmlzVmlzaWJsZSAmJiAhdGhpcy5lbGVtZW50LmNvbnRhaW5zKGUudGFyZ2V0IGFzIE5vZGUpKSB7XG4gICAgICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVEb2N1bWVudENsaWNrKTtcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5RG93bik7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQgJiYgdGhpcy5lbGVtZW50LnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiaW1wb3J0IHtDb25maWdNYW5hZ2VyLCBQYXR0ZXJufSBmcm9tIFwiLi9jb25maWdcIlxuaW1wb3J0IHsgTWF0Y2hGb3JtIH0gZnJvbSBcIi4vbWF0Y2hfZm9ybVwiXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICdvYnNpZGlhbidcblxuXG5leHBvcnQgY2xhc3MgQ29uZmlnRGlhbG9nIGV4dGVuZHMgQ29tcG9uZW50e1xuICAgIHByaXZhdGUgZWxlbWVudDogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBjb25maWdNYW5hZ2VyOiBDb25maWdNYW5hZ2VyO1xuICAgIHByaXZhdGUgY29uZmlnOiBhbnk7XG4gICAgcHJpdmF0ZSBpc1Zpc2libGU6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3Rvcihjb25maWdNYW5hZ2VyOiBDb25maWdNYW5hZ2VyLCBtYXRjaEZvcm06IE1hdGNoRm9ybSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmNvbmZpZ01hbmFnZXIgPSBjb25maWdNYW5hZ2VyO1xuICAgICAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZ01hbmFnZXIuY29uZmlnO1xuICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1hdGNoRm9ybSA9IG1hdGNoRm9ybTtcbiAgICB9XG5cbiAgICBvbmxvYWQoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IHRoaXMuY3JlYXRlRWxlbWVudCgpO1xuICAgICAgICB0aGlzLmhhbmRsZURvY3VtZW50Q2xpY2sgPSB0aGlzLmhhbmRsZURvY3VtZW50Q2xpY2suYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUVsZW1lbnQoKTogSFRNTERpdkVsZW1lbnQge1xuICAgICAgICBjb25zdCBkaWFsb2cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZGlhbG9nLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7XG4gICAgICAgICAgICB0b3A6IDUwJTtcbiAgICAgICAgICAgIGxlZnQ6IDUwJTtcbiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpO1xuICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmFja2dyb3VuZC1zZWNvbmRhcnkpO1xuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXItZm9jdXMpO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICAgICAgcGFkZGluZzogMjBweDtcbiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDEwcHggcmdiYSgwLDAsMCwwLjIpO1xuICAgICAgICAgICAgZGlzcGxheTogbm9uZTtcbiAgICAgICAgICAgIHotaW5kZXg6IDEwMDAyO1xuICAgICAgICAgICAgbWF4LXdpZHRoOiA4MCU7XG4gICAgICAgICAgICBtYXgtaGVpZ2h0OiA4MCU7XG4gICAgICAgICAgICB3aWR0aDogYXV0bztcbiAgICAgICAgICAgIG92ZXJmbG93LXk6IGF1dG87XG4gICAgICAgIGA7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZGlhbG9nKTtcbiAgICAgICAgcmV0dXJuIGRpYWxvZztcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUVkaXRCdXR0b24oY29uZjogUGF0dGVybik6IEhUTUxCdXR0b25FbGVtZW50IHtcbiAgICAgICAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIGJ1dHRvbi5pbm5lckhUTUwgPSAnXHUyNzBGXHVGRTBGJzsgLy8gRWRpdCBpY29uXG4gICAgICAgIGJ1dHRvbi5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgbWFyZ2luLWxlZnQ6IDhweDtcbiAgICAgICAgICAgIGJvcmRlcjogbm9uZTtcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IG5vbmU7XG4gICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgICBmb250LXNpemU6IDE2cHg7XG4gICAgICAgICAgICBwYWRkaW5nOiAycHggNnB4O1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICAgICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcbiAgICAgICAgYDtcbiAgICAgICAgYnV0dG9uLnRpdGxlID0gJ0VkaXQgcGF0dGVybic7XG5cbiAgICAgICAgdGhpcy5yZWdpc3RlckRvbUV2ZW50KGJ1dHRvbiwnY2xpY2snLCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsgLy8gUHJldmVudCBkaWFsb2cgZnJvbSBjbG9zaW5nXG4gICAgICAgICAgICB0aGlzLm1hdGNoRm9ybS5zaG93KGNvbmYpO1xuICAgICAgICAgICAgdGhpcy5oaWRlKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBidXR0b247XG4gICAgfVxuXG4gICAgcHVibGljIHNob3coc2VsZWN0ZWRUZXh0OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9ICcnO1xuICAgICAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XG4gICAgICAgIHRpdGxlLmlubmVySFRNTCA9IGBNYXRjaGluZyBQYXR0ZXJucyBmb3IgPGNvZGU+JHtzZWxlY3RlZFRleHR9PC9jb2RlPmA7XG4gICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZCh0aXRsZSk7XG5cbiAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHRoaXMuY29uZmlnTWFuYWdlci5tYXRjaGVyLmdldE1hdGNoaW5nUGF0dGVybnMoc2VsZWN0ZWRUZXh0KTtcbiAgICAgICAgZm9yIChjb25zdCB7IHZhbHVlLCB3aWxkY2FyZE1hdGNoZXMgfSBvZiBtYXRjaGVzKSB7XG4gICAgICAgICAgICBjb25zdCB7IHBhdHRlcm4sIHJlcGxhY2VtZW50cywgZmFzdFJlcGxhY2UgfSA9IHZhbHVlO1xuICAgICAgICAgICAgY29uc3QgcGF0dGVybkRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG4gICAgICAgICAgICAvLyBDcmVhdGUgcGF0dGVybiBoZWFkZXIgd2l0aCBlZGl0IGJ1dHRvblxuICAgICAgICAgICAgY29uc3QgcGF0dGVybkhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XG4gICAgICAgICAgICBwYXR0ZXJuSGVhZGVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XG4gICAgICAgICAgICBwYXR0ZXJuSGVhZGVyLnN0eWxlLmFsaWduSXRlbXMgPSAnY2VudGVyJztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIGZhc3QgcmVwbGFjZSBpbmRpY2F0b3IgaWYgZW5hYmxlZFxuICAgICAgICAgICAgaWYgKGZhc3RSZXBsYWNlICYmIHJlcGxhY2VtZW50cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmYXN0UmVwbGFjZUljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgICAgICAgICAgZmFzdFJlcGxhY2VJY29uLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAjMjJjNTVlO1xuICAgICAgICAgICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDhweDtcbiAgICAgICAgICAgICAgICBgO1xuICAgICAgICAgICAgICAgIGZhc3RSZXBsYWNlSWNvbi50aXRsZSA9ICdGYXN0IFJlcGxhY2UgRW5hYmxlZCc7XG4gICAgICAgICAgICAgICAgZmFzdFJlcGxhY2VJY29uLnRleHRDb250ZW50ID0gJ1x1MjZBMSc7XG4gICAgICAgICAgICAgICAgcGF0dGVybkhlYWRlci5hcHBlbmRDaGlsZChmYXN0UmVwbGFjZUljb24pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBwYXR0ZXJuVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICAgIHBhdHRlcm5UZXh0LmlubmVySFRNTCA9IGBQYXR0ZXJuOiA8Y29kZT4ke3BhdHRlcm59PC9jb2RlPmA7XG4gICAgICAgICAgICBwYXR0ZXJuSGVhZGVyLmFwcGVuZENoaWxkKHBhdHRlcm5UZXh0KTtcbiAgICAgICAgICAgIHBhdHRlcm5IZWFkZXIuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVFZGl0QnV0dG9uKHZhbHVlKSk7XG5cbiAgICAgICAgICAgIHBhdHRlcm5EaXYuYXBwZW5kQ2hpbGQocGF0dGVybkhlYWRlcik7XG5cbiAgICAgICAgICAgIC8vIEFkZCByZXBsYWNlbWVudHMgbGlzdFxuICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnRzTGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XG4gICAgICAgICAgICByZXBsYWNlbWVudHNMaXN0LmlubmVySFRNTCA9IHJlcGxhY2VtZW50c1xuICAgICAgICAgICAgICAgIC5tYXAociA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlbmRlcmVkID0gKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyLnN0YXJ0c1dpdGgoXCJUOlwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByLnNsaWNlKDIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25maWdNYW5hZ2VyLm1hdGNoZXIucmVwbGFjZVBsYWNlaG9sZGVycyhyLCB3aWxkY2FyZE1hdGNoZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KSgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYDxsaT4kJHtyZW5kZXJlZH0kIDxjb2RlPlske3J9XTwvY29kZT48L2xpPmA7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuam9pbignJyk7XG4gICAgICAgICAgICBwYXR0ZXJuRGl2LmFwcGVuZENoaWxkKHJlcGxhY2VtZW50c0xpc3QpO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHBhdHRlcm5EaXYpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBc3N1bWluZyBNYXRoSmF4IGlzIGdsb2JhbGx5IGF2YWlsYWJsZVxuICAgICAgICAgICAgKHdpbmRvdyBhcyBhbnkpLk1hdGhKYXgudHlwZXNldFByb21pc2UoW3BhdHRlcm5EaXZdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtYXRjaGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgY29uc3Qgbm9NYXRjaCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICAgICAgICAgIG5vTWF0Y2gudGV4dENvbnRlbnQgPSAnTm8gbWF0Y2hpbmcgcGF0dGVybnMgZm91bmQuJztcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChub01hdGNoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNsb3NlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIGNsb3NlQnV0dG9uLnRleHRDb250ZW50ID0gJ0Nsb3NlJztcbiAgICAgICAgY2xvc2VCdXR0b24ub25jbGljayA9ICgpID0+IHsgdGhpcy5oaWRlKCk7IH07XG4gICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChjbG9zZUJ1dHRvbik7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IHRydWU7XG4gICAgfVxuXG4gICAgcHVibGljIGhpZGUoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IGZhbHNlO1xuICAgIH1cblxuICAgIHB1YmxpYyBoYW5kbGVEb2N1bWVudENsaWNrKGU6IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuaXNWaXNpYmxlICYmICF0aGlzLmVsZW1lbnQuY29udGFpbnMoZS50YXJnZXQgYXMgTm9kZSkpIHtcbiAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwgImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJ29ic2lkaWFuJ1xuaW1wb3J0IHsgTWF0Y2hGb3JtIH0gZnJvbSBcIi4vbWF0Y2hfZm9ybVwiXG5cbmV4cG9ydCBjbGFzcyBTZWxlY3Rpb25CdXR0b24gZXh0ZW5kcyBDb21wb25lbnR7XG4gICAgcHJpdmF0ZSBjb25maWdNYW5hZ2VyOiBDb25maWdNYW5hZ2VyO1xuICAgIHByaXZhdGUgZWxlbWVudDogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBzZWxlY3Rpb25UaW1lb3V0OiBudW1iZXIgfCBudWxsO1xuICAgIHByaXZhdGUgY29uZmlnRGlhbG9nOiBDb25maWdEaWFsb2c7XG4gICAgcHJpdmF0ZSBoYXNNYXRjaDogYm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZ01hbmFnZXI6IENvbmZpZ01hbmFnZXIsIGNvbmZpZ0RpYWxvZzogQ29uZmlnRGlhbG9nLCBtYXRjaEZvcm06IE1hdGNoRm9ybSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmNvbmZpZ01hbmFnZXIgPSBjb25maWdNYW5hZ2VyO1xuICAgICAgICB0aGlzLnNlbGVjdGlvblRpbWVvdXQgPSBudWxsO1xuICAgICAgICB0aGlzLmNvbmZpZ0RpYWxvZyA9IGNvbmZpZ0RpYWxvZztcbiAgICAgICAgdGhpcy5oYXNNYXRjaCA9IGZhbHNlO1xuICAgICAgICB0aGlzLm1hdGNoRm9ybSA9IG1hdGNoRm9ybTtcbiAgICB9XG5cbiAgICBvbmxvYWQoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IHRoaXMuY3JlYXRlRWxlbWVudCgpO1xuICAgICAgICB0aGlzLmF0dGFjaEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUVsZW1lbnQoKTogSFRNTEJ1dHRvbkVsZW1lbnQge1xuICAgICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgICAgYnV0dG9uLnN0eWxlLmNzc1RleHQgPSBgXG4gICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICBkaXNwbGF5OiBub25lO1xuICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2NjYztcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcbiAgICAgICAgICAgIHdpZHRoOiAyNHB4O1xuICAgICAgICAgICAgaGVpZ2h0OiAyNHB4O1xuICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICAgICAgei1pbmRleDogMTAwMDE7XG4gICAgICAgICAgICBmb250LXNpemU6IDE2cHg7XG4gICAgICAgICAgICBsaW5lLWhlaWdodDogMjRweDtcbiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgICAgIHBhZGRpbmc6IDA7XG4gICAgICAgIGA7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcbiAgICAgICAgcmV0dXJuIGJ1dHRvbjtcbiAgICB9XG5cbiAgICBwcml2YXRlIGF0dGFjaEV2ZW50TGlzdGVuZXJzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRG9tRXZlbnQodGhpcy5lbGVtZW50LCAnY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZFRleHQgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk/LnRvU3RyaW5nKCkudHJpbSgpID8/ICcnO1xuICAgICAgICAgICAgaWYgKHRoaXMuaGFzTWF0Y2gpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZ0RpYWxvZy5zaG93KHNlbGVjdGVkVGV4dCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubWF0Y2hGb3JtLnNob3coe3BhdHRlcm46IHNlbGVjdGVkVGV4dCwgcmVwbGFjZW1lbnRzOltdfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk/LmVtcHR5KCk7XG4gICAgICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAna2V5dXAnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAnbW91c2V1cCcsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlU2VsZWN0aW9uKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHB1YmxpYyBzaG93KHg6IG51bWJlciwgeTogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5sZWZ0ID0gYCR7eH1weGA7XG4gICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS50b3AgPSBgJHt5fXB4YDtcbiAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgIH1cblxuICAgIHB1YmxpYyBoaWRlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICB9XG5cbiAgICBwdWJsaWMgaGFuZGxlU2VsZWN0aW9uKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25UaW1lb3V0KSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5zZWxlY3Rpb25UaW1lb3V0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2VsZWN0aW9uVGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkVGV4dCA9IHNlbGVjdGlvbj8udG9TdHJpbmcoKS50cmltKCkgPz8gJyc7XG5cbiAgICAgICAgICAgIGlmIChzZWxlY3RlZFRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGFzTWF0Y2ggPSB0aGlzLmNvbmZpZ01hbmFnZXIubWF0Y2hlci5nZXRNYXRjaGluZ1BhdHRlcm5zKHNlbGVjdGVkVGV4dCkubGVuZ3RoID4gMDtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUJ1dHRvbkFwcGVhcmFuY2UoKTtcbiAgICAgICAgICAgICAgICBjb25zdCByYW5nZSA9IHNlbGVjdGlvbj8uZ2V0UmFuZ2VBdCgwKTtcbiAgICAgICAgICAgICAgICBjb25zdCByZWN0ID0gcmFuZ2U/LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgICAgIGlmIChyZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdyhyZWN0LnJpZ2h0ICsgd2luZG93LnBhZ2VYT2Zmc2V0LCByZWN0LnRvcCArIHdpbmRvdy5wYWdlWU9mZnNldCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgNzApO1xuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlQnV0dG9uQXBwZWFyYW5jZSgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuaGFzTWF0Y2gpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC50ZXh0Q29udGVudCA9ICdcdTI2OTlcdUZFMEYnO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnRpdGxlID0gJ1ZpZXcgbWF0Y2hpbmcgcGF0dGVybnMnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnRleHRDb250ZW50ID0gJysnO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnRpdGxlID0gJ0FkZCBuZXcgcGF0dGVybic7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnb2JzaWRpYW4nXG5pbXBvcnQgeyBDb25maWdNYW5hZ2VyLCBNYXRoQ29uZmlnLCBQYXR0ZXJuIH0gZnJvbSBcIi4vY29uZmlnXCJcblxuZXhwb3J0IGNsYXNzIE1hdGNoRm9ybSBleHRlbmRzIENvbXBvbmVudHtcbiAgICBwcml2YXRlIGNvbmZpZ01hbmFnZXI6IENvbmZpZ01hbmFnZXI7XG4gICAgcHJpdmF0ZSBjb25maWc6IE1hdGhDb25maWc7XG4gICAgcHJpdmF0ZSBtYXRjaERhdGE6IFBhdHRlcm5Db25maWcgfCBudWxsO1xuICAgIHByaXZhdGUgZWxlbWVudDogSFRNTERpdkVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3Rvcihjb25maWdNYW5hZ2VyOiBDb25maWdNYW5hZ2VyKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuY29uZmlnTWFuYWdlciA9IGNvbmZpZ01hbmFnZXI7XG4gICAgfVxuXG4gICAgb25sb2FkKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLmNyZWF0ZUVsZW1lbnQoKTtcblxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlRWxlbWVudCgpOiBIVE1MRGl2RWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZm9ybS5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkO1xuICAgICAgICAgICAgdG9wOiA1MCU7XG4gICAgICAgICAgICBsZWZ0OiA1MCU7XG4gICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTtcbiAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSk7XG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgICAgICBwYWRkaW5nOiAyMHB4O1xuICAgICAgICAgICAgYm94LXNoYWRvdzogMCAycHggMTBweCByZ2JhKDAsMCwwLDAuMik7XG4gICAgICAgICAgICB6LWluZGV4OiAxMDAwMztcbiAgICAgICAgICAgIG1heC13aWR0aDogODAlO1xuICAgICAgICAgICAgbWF4LWhlaWdodDogODAlO1xuICAgICAgICAgICAgb3ZlcmZsb3cteTogYXV0bztcbiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7XG4gICAgICAgIGA7XG5cbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChmb3JtKTtcblxuICAgICAgICByZXR1cm4gZm9ybTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZUNvbnRlbnQoKSB7XG4gICAgICAgIC8vIENyZWF0ZSBmYXN0IHJlcGxhY2UgdG9nZ2xlIHNlY3Rpb25cbiAgICAgICAgY29uc3QgZmFzdFJlcGxhY2VIdG1sID0gYFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImZhc3QtcmVwbGFjZS1zZWN0aW9uXCIgc3R5bGU9XCJtYXJnaW4tdG9wOiAxNXB4OyBtYXJnaW4tYm90dG9tOiAxNXB4O1wiPlxuICAgICAgICAgICAgICAgIDxsYWJlbCBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogOHB4O1wiPlxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJmYXN0UmVwbGFjZVwiICR7dGhpcy5tYXRjaERhdGE/LmZhc3RSZXBsYWNlID8gJ2NoZWNrZWQnIDogJyd9PlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICBGYXN0IFJlcGxhY2VcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPVwiY29sb3I6ICMyMmM1NWU7IG1hcmdpbi1sZWZ0OiA0cHg7XCI+XHUyNkExPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgPC9sYWJlbD5cbiAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVwiZm9udC1zaXplOiAwLjhlbTsgY29sb3I6ICM2NjY7IG1hcmdpbi10b3A6IDRweDtcIj5cbiAgICAgICAgICAgICAgICAgICAgRW5hYmxlcyBxdWljayByZXBsYWNlbWVudCB3aXRoIGFueSBub24tYWxwaGFudW1lcmljIGNoYXJhY3RlclxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIGA7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxoMj4ke3RoaXMubWF0Y2hEYXRhID8gJ0VkaXQgUGF0dGVybicgOiAnQ3JlYXRlIE5ldyBQYXR0ZXJuJ308L2gyPlxuICAgICAgICAgICAgPGxhYmVsIGZvcj1cInBhdHRlcm5cIj5QYXR0ZXJuIChyZWdleCk6PC9sYWJlbD5cbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIGlkPVwicGF0dGVyblwiIHZhbHVlPVwiJHt0aGlzLm1hdGNoRGF0YSA/IHRoaXMubWF0Y2hEYXRhLnBhdHRlcm4gOiAnJ31cIj48YnI+PGJyPlxuICAgICAgICAgICAgJHtmYXN0UmVwbGFjZUh0bWx9XG4gICAgICAgICAgICA8ZGl2IGlkPVwicmVwbGFjZW1lbnRzXCI+PC9kaXY+XG4gICAgICAgICAgICA8YnV0dG9uIGlkPVwiYWRkUmVwbGFjZW1lbnRcIj5BZGQgUmVwbGFjZW1lbnQ8L2J1dHRvbj48YnI+PGJyPlxuICAgICAgICAgICAgPGJ1dHRvbiBpZD1cInNhdmVNYXRjaFwiPlNhdmU8L2J1dHRvbj5cbiAgICAgICAgICAgIDxidXR0b24gaWQ9XCJjYW5jZWxNYXRjaFwiPkNhbmNlbDwvYnV0dG9uPlxuICAgICAgICBgO1xuICAgICAgICBpZiAodGhpcy5tYXRjaERhdGEpIHtcbiAgICAgICAgICAgIHRoaXMubWF0Y2hEYXRhLnJlcGxhY2VtZW50cy5mb3JFYWNoKHJlcGxhY2VtZW50ID0+IHtcbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgcmVwbGFjZW1lbnQgaXMgYSB0ZW1wbGF0ZVxuICAgICAgICAgICAgICAgIGNvbnN0IGlzVGVtcGxhdGUgPSByZXBsYWNlbWVudC5zdGFydHNXaXRoKCdUOicpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGFjdHVhbFJlcGxhY2VtZW50ID0gaXNUZW1wbGF0ZSA/IHJlcGxhY2VtZW50LnNsaWNlKDIpIDogcmVwbGFjZW1lbnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRSZXBsYWNlbWVudEZpZWxkKGFjdHVhbFJlcGxhY2VtZW50LCBpc1RlbXBsYXRlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hZGRSZXBsYWNlbWVudEZpZWxkKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hdHRhY2hFdmVudExpc3RlbmVycygpO1xuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhdHRhY2hFdmVudExpc3RlbmVycygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYWRkUmVwbGFjZW1lbnRCdXR0b24gPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI2FkZFJlcGxhY2VtZW50Jyk7XG4gICAgICAgIGNvbnN0IHNhdmVNYXRjaEJ1dHRvbiA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjc2F2ZU1hdGNoJyk7XG4gICAgICAgIGNvbnN0IGNhbmNlbE1hdGNoQnV0dG9uID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJyNjYW5jZWxNYXRjaCcpO1xuXG4gICAgICAgIGlmIChhZGRSZXBsYWNlbWVudEJ1dHRvbiAmJiBzYXZlTWF0Y2hCdXR0b24gJiYgY2FuY2VsTWF0Y2hCdXR0b24pIHtcbiAgICAgICAgICAgIGFkZFJlcGxhY2VtZW50QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkUmVwbGFjZW1lbnRGaWVsZCgpO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRmFzdFJlcGxhY2VTdGF0ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzYXZlTWF0Y2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLnNhdmVNYXRjaCgpKTtcbiAgICAgICAgICAgIGNhbmNlbE1hdGNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5oaWRlKCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB1cGRhdGVGYXN0UmVwbGFjZVN0YXRlKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBmYXN0UmVwbGFjZUNoZWNrYm94ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJyNmYXN0UmVwbGFjZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IHJlcGxhY2VtZW50cyA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjcmVwbGFjZW1lbnRzIGZpZWxkc2V0Jyk7XG5cbiAgICAgICAgaWYgKGZhc3RSZXBsYWNlQ2hlY2tib3gpIHtcbiAgICAgICAgICAgIC8vIERpc2FibGUgZmFzdCByZXBsYWNlIGlmIHRoZXJlJ3MgbW9yZSB0aGFuIG9uZSByZXBsYWNlbWVudFxuICAgICAgICAgICAgaWYgKHJlcGxhY2VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgZmFzdFJlcGxhY2VDaGVja2JveC5jaGVja2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgZmFzdFJlcGxhY2VDaGVja2JveC5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgZmFzdFJlcGxhY2VDaGVja2JveC50aXRsZSA9ICdGYXN0IHJlcGxhY2UgaXMgb25seSBhdmFpbGFibGUgZm9yIHBhdHRlcm5zIHdpdGggYSBzaW5nbGUgcmVwbGFjZW1lbnQnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmYXN0UmVwbGFjZUNoZWNrYm94LmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgZmFzdFJlcGxhY2VDaGVja2JveC50aXRsZSA9ICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhZGRSZXBsYWNlbWVudEZpZWxkKHJlcGxhY2VtZW50OiBzdHJpbmcgPSAnJywgaXNUZW1wbGF0ZTogYm9vbGVhbiA9IGZhbHNlKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJlcGxhY2VtZW50c0RpdiA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjcmVwbGFjZW1lbnRzJyk7XG4gICAgICAgIGlmICghcmVwbGFjZW1lbnRzRGl2KSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgZmllbGRTZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmaWVsZHNldCcpO1xuICAgICAgICBmaWVsZFNldC5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTBweDtcbiAgICAgICAgICAgIHBhZGRpbmc6IDEwcHg7XG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjZGRkO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICBgO1xuXG4gICAgICAgIGZpZWxkU2V0LmlubmVySFRNTCA9IGBcbiAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDEwcHg7XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBzdHlsZT1cImZsZXgtZ3JvdzogMTtcIj5cbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj1cInJlcGxhY2VtZW50XCI+UmVwbGFjZW1lbnQ6PC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJyZXBsYWNlbWVudFwiIHZhbHVlPVwiJHtyZXBsYWNlbWVudH1cIiBzdHlsZT1cIndpZHRoOiAxMDAlO1wiPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgIDxsYWJlbCBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNHB4O1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNsYXNzPVwidGVtcGxhdGUtY2hlY2tib3hcIiAke2lzVGVtcGxhdGUgPyAnY2hlY2tlZCcgOiAnJ30+XG4gICAgICAgICAgICAgICAgICAgICAgICBUZW1wbGF0ZVxuICAgICAgICAgICAgICAgICAgICA8L2xhYmVsPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJyZW1vdmVSZXBsYWNlbWVudFwiIHN0eWxlPVwibWFyZ2luLWxlZnQ6IGF1dG87XCI+UmVtb3ZlPC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcblxuICAgICAgICBjb25zdCByZW1vdmVCdXR0b24gPSBmaWVsZFNldC5xdWVyeVNlbGVjdG9yKCcucmVtb3ZlUmVwbGFjZW1lbnQnKTtcbiAgICAgICAgaWYgKHJlbW92ZUJ1dHRvbikge1xuICAgICAgICAgICAgcmVtb3ZlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGZpZWxkU2V0LnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRmFzdFJlcGxhY2VTdGF0ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmVwbGFjZW1lbnRzRGl2LmFwcGVuZENoaWxkKGZpZWxkU2V0KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNhdmVNYXRjaCgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcGF0dGVybklucHV0ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwYXR0ZXJuJykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgY29uc3QgZmFzdFJlcGxhY2VDaGVja2JveCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjZmFzdFJlcGxhY2UnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBjb25zdCByZXBsYWNlbWVudEZpZWxkc2V0cyA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjcmVwbGFjZW1lbnRzIGZpZWxkc2V0Jyk7XG5cbiAgICAgICAgaWYgKCFwYXR0ZXJuSW5wdXQpIHJldHVybjtcblxuICAgICAgICBjb25zdCBwYXR0ZXJuID0gcGF0dGVybklucHV0LnZhbHVlO1xuICAgICAgICBjb25zdCByZXBsYWNlbWVudHMgPSBBcnJheS5mcm9tKHJlcGxhY2VtZW50RmllbGRzZXRzKS5tYXAoZmllbGRzZXQgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnRJbnB1dCA9IGZpZWxkc2V0LnF1ZXJ5U2VsZWN0b3IoJy5yZXBsYWNlbWVudCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgICAgICBjb25zdCB0ZW1wbGF0ZUNoZWNrYm94ID0gZmllbGRzZXQucXVlcnlTZWxlY3RvcignLnRlbXBsYXRlLWNoZWNrYm94JykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VtZW50VmFsdWUgPSByZXBsYWNlbWVudElucHV0Py52YWx1ZSB8fCAnJztcbiAgICAgICAgICAgIGNvbnN0IGlzVGVtcGxhdGUgPSB0ZW1wbGF0ZUNoZWNrYm94Py5jaGVja2VkIHx8IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIGlzVGVtcGxhdGUgPyBgVDoke3JlcGxhY2VtZW50VmFsdWV9YCA6IHJlcGxhY2VtZW50VmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBmYXN0UmVwbGFjZSA9IGZhc3RSZXBsYWNlQ2hlY2tib3g/LmNoZWNrZWQgfHwgZmFsc2U7XG5cbiAgICAgICAgaWYgKHRoaXMubWF0Y2hEYXRhKSB7XG4gICAgICAgICAgICAvLyBSZW1vdmUgb2xkIHBhdHRlcm5cbiAgICAgICAgICAgIGNvbnN0IG9sZFBhdHRlcm5JbmRleCA9IHRoaXMuY29uZmlnTWFuYWdlci5jb25maWcucGF0dGVybnMuZmluZEluZGV4KHAgPT5cbiAgICAgICAgICAgICAgICBwLnBhdHRlcm4gPT09IHRoaXMubWF0Y2hEYXRhLnBhdHRlcm5cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAob2xkUGF0dGVybkluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnTWFuYWdlci5jb25maWcucGF0dGVybnMuc3BsaWNlKG9sZFBhdHRlcm5JbmRleCwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBZGQgbmV3IHBhdHRlcm5cbiAgICAgICAgdGhpcy5jb25maWdNYW5hZ2VyLmNvbmZpZy5wYXR0ZXJucy5wdXNoKHtcbiAgICAgICAgICAgIHBhdHRlcm4sXG4gICAgICAgICAgICByZXBsYWNlbWVudHMsXG4gICAgICAgICAgICBmYXN0UmVwbGFjZVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTYXZlIGNvbmZpZ1xuICAgICAgICB0aGlzLmNvbmZpZ01hbmFnZXIudXBkYXRlQ29uZmlnKCk7XG5cbiAgICAgICAgdGhpcy5oaWRlKCk7XG4gICAgfVxuXG4gICAgcHVibGljIHNob3cobWF0Y2hEYXRhOiBQYXR0ZXJuIHwgbnVsbCA9IG51bGwpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5tYXRjaERhdGEgPSBtYXRjaERhdGE7XG4gICAgICAgIHRoaXMudXBkYXRlQ29udGVudCgpO1xuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgfVxuXG4gICAgcHVibGljIGhpZGUoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICB0aGlzLmVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XG4gICAgfVxufVxuIiwgImltcG9ydCB7XG4gICAgSXRlbVZpZXcsXG4gICAgV29ya3NwYWNlTGVhZixcbiAgICBQbHVnaW4sXG4gICAgTWFya2Rvd25SZW5kZXJlclxufSBmcm9tICdvYnNpZGlhbic7XG5cbmltcG9ydCB7IFBhdHRlcm4gfSBmcm9tICcuL2NvbmZpZyc7XG5cbmV4cG9ydCBjb25zdCBDT05GSUdfVklFV19UWVBFID0gJ2NvbmZpZy1yZWZlcmVuY2Utdmlldyc7XG5cbmV4cG9ydCBjbGFzcyBDb25maWdWaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xuICAgIHByaXZhdGUgY29uZmlnTWFuYWdlcjogQ29uZmlnTWFuYWdlcjtcblxuICAgIGNvbnN0cnVjdG9yKGxlYWY6IFdvcmtzcGFjZUxlYWYsIGNvbmZpZ01hbmFnZXI6IENvbmZpZ01hbmFnZXIpIHtcbiAgICAgICAgc3VwZXIobGVhZik7XG4gICAgICAgIHRoaXMuY29uZmlnTWFuYWdlciA9IGNvbmZpZ01hbmFnZXI7XG4gICAgfVxuXG4gICAgZ2V0Vmlld1R5cGUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIENPTkZJR19WSUVXX1RZUEU7XG4gICAgfVxuXG4gICAgZ2V0RGlzcGxheVRleHQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuICdMYVRlWCBTaG9ydGN1dHMgUmVmZXJlbmNlJztcbiAgICB9XG5cbiAgICBhc3luYyBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY2hpbGRyZW5bMV07XG4gICAgICAgIGNvbnRhaW5lci5lbXB0eSgpO1xuXG4gICAgICAgIC8vIENyZWF0ZSBoZWFkZXIgd2l0aCBjbG9zZSBidXR0b25cbiAgICAgICAgY29uc3QgaGVhZGVyQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ2NvbmZpZy12aWV3LWhlYWRlcicgfSk7XG4gICAgICAgIGhlYWRlckNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuICAgICAgICBoZWFkZXJDb250YWluZXIuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnc3BhY2UtYmV0d2Vlbic7XG4gICAgICAgIGhlYWRlckNvbnRhaW5lci5zdHlsZS5hbGlnbkl0ZW1zID0gJ2NlbnRlcic7XG4gICAgICAgIGhlYWRlckNvbnRhaW5lci5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMjBweCc7XG5cbiAgICAgICAgaGVhZGVyQ29udGFpbmVyLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0xhVGVYIFNob3J0Y3V0cyBSZWZlcmVuY2UnIH0pO1xuXG4gICAgICAgIGNvbnN0IGNsb3NlQnV0dG9uID0gaGVhZGVyQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IGNsczogJ2NvbmZpZy12aWV3LWNsb3NlJyB9KTtcbiAgICAgICAgY2xvc2VCdXR0b24uc3R5bGUuY3NzVGV4dCA9IGBcbiAgICAgICAgICAgIHBhZGRpbmc6IDRweCA4cHg7XG4gICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuICAgICAgICBgO1xuICAgICAgICBjbG9zZUJ1dHRvbi5zZXRUZXh0KCdcdTI3MTUnKTtcbiAgICAgICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBjbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuZGV0YWNoTGVhdmVzT2ZUeXBlKENPTkZJR19WSUVXX1RZUEUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENyZWF0ZSBzZWFyY2ggaW5wdXRcbiAgICAgICAgY29uc3Qgc2VhcmNoQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3NlYXJjaC1jb250YWluZXInIH0pO1xuICAgICAgICBzZWFyY2hDb250YWluZXIuc3R5bGUubWFyZ2luID0gJzEwcHggMCc7XG4gICAgICAgIGNvbnN0IHNlYXJjaElucHV0ID0gc2VhcmNoQ29udGFpbmVyLmNyZWF0ZUVsKCdpbnB1dCcsIHtcbiAgICAgICAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnU2VhcmNoIHBhdHRlcm5zLi4uJ1xuICAgICAgICB9KTtcbiAgICAgICAgc2VhcmNoSW5wdXQuc3R5bGUud2lkdGggPSAnMTAwJSc7XG4gICAgICAgIHNlYXJjaElucHV0LnN0eWxlLnBhZGRpbmcgPSAnNXB4JztcblxuICAgICAgICAvLyBDcmVhdGUgcGF0dGVybnMgY29udGFpbmVyXG4gICAgICAgIGNvbnN0IHBhdHRlcm5zQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IGNsczogJ3BhdHRlcm5zLWNvbnRhaW5lcicgfSk7XG5cbiAgICAgICAgLy8gR3JvdXAgcGF0dGVybnMgYnkgY2F0ZWdvcnlcbiAgICAgICAgY29uc3QgY2F0ZWdvcmllcyA9IHRoaXMuZ3JvdXBQYXR0ZXJuc0J5Q2F0ZWdvcnkodGhpcy5jb25maWdNYW5hZ2VyLmNvbmZpZy5wYXR0ZXJucyk7XG5cbiAgICAgICAgLy8gRnVuY3Rpb24gdG8gcmVuZGVyIHBhdHRlcm5zXG4gICAgICAgIGNvbnN0IHJlbmRlclBhdHRlcm5zID0gKHNlYXJjaFRlcm06IHN0cmluZyA9ICcnKSA9PiB7XG4gICAgICAgICAgICBwYXR0ZXJuc0NvbnRhaW5lci5lbXB0eSgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtjYXRlZ29yeSwgcGF0dGVybnNdIG9mIE9iamVjdC5lbnRyaWVzKGNhdGVnb3JpZXMpKSB7XG4gICAgICAgICAgICAgICAgLy8gRmlsdGVyIHBhdHRlcm5zIGJhc2VkIG9uIHNlYXJjaCB0ZXJtXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsdGVyZWRQYXR0ZXJucyA9IHBhdHRlcm5zLmZpbHRlcihwYXR0ZXJuID0+IFxuICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuLnBhdHRlcm4udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2hUZXJtLnRvTG93ZXJDYXNlKCkpIHx8XG4gICAgICAgICAgICAgICAgICAgIHBhdHRlcm4ucmVwbGFjZW1lbnRzLnNvbWUociA9PiByLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoVGVybS50b0xvd2VyQ2FzZSgpKSlcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZpbHRlcmVkUGF0dGVybnMubGVuZ3RoID09PSAwKSBjb250aW51ZTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGNhdGVnb3J5RWwgPSBwYXR0ZXJuc0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2JywgeyBjbHM6ICdjYXRlZ29yeScgfSk7XG4gICAgICAgICAgICAgICAgY2F0ZWdvcnlFbC5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMjBweCc7XG5cbiAgICAgICAgICAgICAgICBjYXRlZ29yeUVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogY2F0ZWdvcnkgfSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3QgdGFibGUgPSBjYXRlZ29yeUVsLmNyZWF0ZUVsKCd0YWJsZScpO1xuICAgICAgICAgICAgICAgIHRhYmxlLnN0eWxlLndpZHRoID0gJzEwMCUnO1xuICAgICAgICAgICAgICAgIHRhYmxlLnN0eWxlLmJvcmRlckNvbGxhcHNlID0gJ2NvbGxhcHNlJztcblxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBoZWFkZXJcbiAgICAgICAgICAgICAgICBjb25zdCB0aGVhZCA9IHRhYmxlLmNyZWF0ZUVsKCd0aGVhZCcpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlclJvdyA9IHRoZWFkLmNyZWF0ZUVsKCd0cicpO1xuICAgICAgICAgICAgICAgIFsnUGF0dGVybicsICdQcmV2aWV3JywgJ0xhVGVYJ10uZm9yRWFjaChoZWFkZXIgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0aCA9IGhlYWRlclJvdy5jcmVhdGVFbCgndGgnKTtcbiAgICAgICAgICAgICAgICAgICAgdGguc3R5bGUudGV4dEFsaWduID0gJ2xlZnQnO1xuICAgICAgICAgICAgICAgICAgICB0aC5zdHlsZS5wYWRkaW5nID0gJzhweCc7XG4gICAgICAgICAgICAgICAgICAgIHRoLnN0eWxlLmJvcmRlckJvdHRvbSA9ICcxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcbiAgICAgICAgICAgICAgICAgICAgdGguc2V0VGV4dChoZWFkZXIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHJvd3NcbiAgICAgICAgICAgICAgICBjb25zdCB0Ym9keSA9IHRhYmxlLmNyZWF0ZUVsKCd0Ym9keScpO1xuICAgICAgICAgICAgICAgIGZpbHRlcmVkUGF0dGVybnMuZm9yRWFjaChwYXR0ZXJuID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcGF0dGVybi5yZXBsYWNlbWVudHMuZm9yRWFjaCgocmVwbGFjZW1lbnQsIGlkeCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm93ID0gdGJvZHkuY3JlYXRlRWwoJ3RyJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBhdHRlcm4gY2VsbCAob25seSBmb3IgZmlyc3QgcmVwbGFjZW1lbnQpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXR0ZXJuQ2VsbCA9IHJvdy5jcmVhdGVFbCgndGQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm5DZWxsLnN0eWxlLnBhZGRpbmcgPSAnOHB4JztcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm5DZWxsLnN0eWxlLnZlcnRpY2FsQWxpZ24gPSAnbWlkZGxlJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZHggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5mYXN0UmVwbGFjZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpY29uID0gcGF0dGVybkNlbGwuY3JlYXRlRWwoJ3NwYW4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbi5zdHlsZS5jc3NUZXh0ID0gYFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICMyMmM1NWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDRweDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44ZW07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb24uc2V0QXR0cmlidXRlKCd0aXRsZScsICdGYXN0IFJlcGxhY2UgRW5hYmxlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uLnNldFRleHQoJ1x1MjZBMScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuQ2VsbC5jcmVhdGVFbCgnY29kZScsIHsgdGV4dDogcGF0dGVybi5wYXR0ZXJuIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0dGVybkNlbGwuc3R5bGUuYm9yZGVyQm90dG9tID0gaWR4ID09PSBwYXR0ZXJuLnJlcGxhY2VtZW50cy5sZW5ndGggLSAxID8gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzJweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlci1mb2N1cyknIDogXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJzFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBQcmV2aWV3IGNlbGxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZpZXdDZWxsID0gcm93LmNyZWF0ZUVsKCd0ZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld0NlbGwuc3R5bGUucGFkZGluZyA9ICc4cHgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld0NlbGwuc3R5bGUudmVydGljYWxBbGlnbiA9ICdtaWRkbGUnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld0NlbGwuc3R5bGUuYm9yZGVyQm90dG9tID0gcGF0dGVybkNlbGwuc3R5bGUuYm9yZGVyQm90dG9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdGVtcGxhdGUgcHJlZml4IGlmIHByZXNlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsZWFuUmVwbGFjZW1lbnQgPSByZXBsYWNlbWVudC5zdGFydHNXaXRoKCdUOicpID8gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZW1lbnQuc2xpY2UoMikgOiByZXBsYWNlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVuZGVyIHRoZSBMYVRlWFxuICAgICAgICAgICAgICAgICAgICAgICAgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgJCR7Y2xlYW5SZXBsYWNlbWVudH0kYCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3Q2VsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxlYWYudmlldy5maWxlPy5wYXRoIHx8ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIExhVGVYIGNvZGUgY2VsbFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGF0ZXhDZWxsID0gcm93LmNyZWF0ZUVsKCd0ZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGF0ZXhDZWxsLnN0eWxlLnBhZGRpbmcgPSAnOHB4JztcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhdGV4Q2VsbC5zdHlsZS52ZXJ0aWNhbEFsaWduID0gJ21pZGRsZSc7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXRleENlbGwuc3R5bGUuYm9yZGVyQm90dG9tID0gcGF0dGVybkNlbGwuc3R5bGUuYm9yZGVyQm90dG9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGF0ZXhDZWxsLmNyZWF0ZUVsKCdjb2RlJywgeyB0ZXh0OiByZXBsYWNlbWVudCB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gQWRkIHNlYXJjaCBoYW5kbGVyXG4gICAgICAgIHNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKGUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNlYXJjaFRlcm0gPSAoZS50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWU7XG4gICAgICAgICAgICByZW5kZXJQYXR0ZXJucyhzZWFyY2hUZXJtKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gSW5pdGlhbCByZW5kZXJcbiAgICAgICAgcmVuZGVyUGF0dGVybnMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdyb3VwUGF0dGVybnNCeUNhdGVnb3J5KHBhdHRlcm5zOiBQYXR0ZXJuW10pOiBSZWNvcmQ8c3RyaW5nLCBQYXR0ZXJuW10+IHtcbiAgICAgICAgY29uc3QgY2F0ZWdvcmllczogUmVjb3JkPHN0cmluZywgUGF0dGVybltdPiA9IHtcbiAgICAgICAgICAgICdMb2dpY2FsIE9wZXJhdG9ycyc6IFtdLFxuICAgICAgICAgICAgJ0dyZWVrIExldHRlcnMnOiBbXSxcbiAgICAgICAgICAgICdNYXRoZW1hdGljYWwgT3BlcmF0b3JzJzogW10sXG4gICAgICAgICAgICAnU2V0IFN5bWJvbHMnOiBbXSxcbiAgICAgICAgICAgICdBcnJvd3MnOiBbXSxcbiAgICAgICAgICAgICdGdW5jdGlvbnMnOiBbXSxcbiAgICAgICAgICAgICdQYXJlbnRoZXNlcyc6IFtdLFxuICAgICAgICAgICAgJ090aGVyJzogW11cbiAgICAgICAgfTtcblxuICAgICAgICBwYXR0ZXJucy5mb3JFYWNoKHBhdHRlcm4gPT4ge1xuICAgICAgICAgICAgaWYgKHBhdHRlcm4ucmVwbGFjZW1lbnRzLnNvbWUociA9PiByLmluY2x1ZGVzKCdcXFxcbG9yJykgfHwgci5pbmNsdWRlcygnXFxcXGxhbmQnKSB8fCByLmluY2x1ZGVzKCdcXFxcbG5vdCcpKSkge1xuICAgICAgICAgICAgICAgIGNhdGVnb3JpZXNbJ0xvZ2ljYWwgT3BlcmF0b3JzJ10ucHVzaChwYXR0ZXJuKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGF0dGVybi5yZXBsYWNlbWVudHMuc29tZShyID0+IHIuaW5jbHVkZXMoJ1xcXFxhbHBoYScpIHx8IHIuaW5jbHVkZXMoJ1xcXFxiZXRhJykgfHwgci5pbmNsdWRlcygnXFxcXGdhbW1hJykpKSB7XG4gICAgICAgICAgICAgICAgY2F0ZWdvcmllc1snR3JlZWsgTGV0dGVycyddLnB1c2gocGF0dGVybik7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhdHRlcm4ucmVwbGFjZW1lbnRzLnNvbWUociA9PiByLmluY2x1ZGVzKCdcXFxcc3VtJykgfHwgci5pbmNsdWRlcygnXFxcXHByb2QnKSB8fCByLmluY2x1ZGVzKCdcXFxcaW50JykpKSB7XG4gICAgICAgICAgICAgICAgY2F0ZWdvcmllc1snTWF0aGVtYXRpY2FsIE9wZXJhdG9ycyddLnB1c2gocGF0dGVybik7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhdHRlcm4ucmVwbGFjZW1lbnRzLnNvbWUociA9PiByLmluY2x1ZGVzKCdcXFxcaW4nKSB8fCByLmluY2x1ZGVzKCdcXFxcc3Vic2V0JykpKSB7XG4gICAgICAgICAgICAgICAgY2F0ZWdvcmllc1snU2V0IFN5bWJvbHMnXS5wdXNoKHBhdHRlcm4pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXR0ZXJuLnJlcGxhY2VtZW50cy5zb21lKHIgPT4gci5pbmNsdWRlcygnXFxcXHJpZ2h0YXJyb3cnKSB8fCByLmluY2x1ZGVzKCdcXFxcbGVmdGFycm93JykpKSB7XG4gICAgICAgICAgICAgICAgY2F0ZWdvcmllc1snQXJyb3dzJ10ucHVzaChwYXR0ZXJuKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGF0dGVybi5yZXBsYWNlbWVudHMuc29tZShyID0+IHIuaW5jbHVkZXMoJ1xcXFxzaW4nKSB8fCByLmluY2x1ZGVzKCdcXFxcY29zJykgfHwgci5pbmNsdWRlcygnXFxcXGxvZycpKSkge1xuICAgICAgICAgICAgICAgIGNhdGVnb3JpZXNbJ0Z1bmN0aW9ucyddLnB1c2gocGF0dGVybik7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhdHRlcm4ucmVwbGFjZW1lbnRzLnNvbWUociA9PiByLmluY2x1ZGVzKCdcXFxcYmlnJykgfHwgci5pbmNsdWRlcygnXFxcXEJpZycpKSkge1xuICAgICAgICAgICAgICAgIGNhdGVnb3JpZXNbJ1BhcmVudGhlc2VzJ10ucHVzaChwYXR0ZXJuKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2F0ZWdvcmllc1snT3RoZXInXS5wdXNoKHBhdHRlcm4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBSZW1vdmUgZW1wdHkgY2F0ZWdvcmllc1xuICAgICAgICBPYmplY3Qua2V5cyhjYXRlZ29yaWVzKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICBpZiAoY2F0ZWdvcmllc1trZXldLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBjYXRlZ29yaWVzW2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBjYXRlZ29yaWVzO1xuICAgIH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBUU87OztB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
